--- 
title: "Calcul différentiel et intégral dans l'espace"
author: "Marc-André Désautels"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: ["book.bib", "packages.bib"]
biblio-style: "apalike"
link-citations: yes
github-repo: desautm/calcul3
description: "Un livre sous forme de notes trouées portant sur le calcul différentiel et intégral dans l'espace."
---

# Introduction {-}

## À propos de ce document {-}

### Remerciements {-}

Ce document est généré par l'excellente extension [bookdown](https://bookdown.org/) de [Yihui Xie](https://yihui.name/).

### License {-}

Ce document est mis à disposition selon les termes de la [Licence Creative Commons Attribution - Pas d’Utilisation Commerciale - Partage dans les Mêmes Conditions 4.0 International](http://creativecommons.org/licenses/by-nc-sa/4.0/).

![Licence Creative Commons](resources/icons/license_cc.png)

<!--chapter:end:index.Rmd-->

# Les séries de Taylor {#taylor}

Vous trouverez à la section \@ref(geogebra-taylor) une application [GeoGebra](https://www.geogebra.org/?lang=fr) vous permettant de visualiser les polynômes de Taylor et de Maclaurin d'une fonction de votre choix. À noter que cette application n'est disponible que dans la version en ligne de ce document.

## Les polynômes de Taylor et de MacLaurin

De tous les types de fonctions, les fonctions polynomiales sont celles qui se dérivent et s'intègrent le plus facilement. De plus, si leur degré est inférieur ou égal à 5, des formules permettent de trouver facilement leurs zéros. Pour ces raisons, l'écriture d'une fonction $f(x)$ sous la forme d'un polynôme de degré $n$, $P_n(x)$, nous permet de l'étudier aisément. Cependant, en écrivant une fonction sous la forme d'un polynôme, nous obtenons une approximation.

L'approche de Taylor et de MacLaurin est couramment utilisée pour transformer une fonction en polynôme.

### Les polynômes de MacLaurin

Pour savoir de quelle manière exprimer une fonction $f(x)$ sous la forme d'un polynôme, nous étudierons un cas particulier des polynômes de Taylor, soit les polynômes de MacLaurin.

```{definition name = "Polynôme de Maclaurin"}
Soit $f(x)$ une fonction dérivable au moins $n$ fois. Le __polynôme de MacLaurin__ de degré $n$, $P_n(x)$, de la fonction $f(x)$ est un polynôme satisfaisant les conditions suivantes:
\begin{align}
\begin{split}
f(0) &= P_n(0) \\
\left.\dfrac{d^k f}{dx^k}\right|_{x=0} &= \left.\dfrac{d^k P_n}{dx^k}\right|_{x=0}, \quad \text{pour } k\in\{1,\ldots,n\}
\end{split}
\end{align}
```

Les deux conditions suivantes permettent de construire le polynôme de MacLaurin pour une fonction $f(x)$ quelconque. Nous savons qu'un polynôme de degré $n$ s'écrit de la façon suivante:

\begin{align*}
P_n(x)=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}+a_nx^n
\end{align*}

Pour trouver les coefficients $a_k$, nous devons obtenir les dérivées successives de $P_n(x)$. Ainsi:

\begin{align}
\begin{split}
P_n(x) &= a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}+a_nx^n \\
P_n^{(1)}(x) &= 1a_1+2a_2x+3a_3x^2+...+(n-1)a_{n-1}x^{n-2}+na_nx^{n-1} \\
P_n^{(2)}(x) &= 2\cdot 1a_2+3\cdot 2a_3x+...+(n-1)(n-2)a_{n-1}x^{n-3}+n(n-1)a_nx^{n-2} \\
P_n^{(3)}(x) &= 3\cdot 2\cdot 1a_3+...+(n-1)(n-2)(n-3)a_{n-1}x^{n-4}+n(n-1)(n-2)a_nx^{n-3}
\end{split}
\end{align}
et ainsi de suite.

Par définition, nous savons que $f(0)=P_n(0)$. Ainsi:

\begin{align}
\begin{split}
f(0)&=P_n(0) \\
f(0) &= a_0+a_1(0)+a_2(0)^2+...+a_{n-1}(0)^{n-1}+a_n(0)^n \\
f(0)&=a_0
\end{split}
\end{align}

De même, nous savons que $f^{(1)}(0)=P_n^{(1)}(0)$. Ainsi:

\begin{align}
\begin{split}
f^{(1)}(0)&=P_n^{(1)}(0)\\
f^{(1)}(0)&=1a_1+2a_2(0)+3a_3(0)^2+...+(n-1)a_{n-1}(0)^{n-2}+na_n(0)^{n-1} \\
f^{(1)}(0)&=1a_1  \\
\dfrac{f^{(1)}(0)}{1}&=a_1
\end{split}
\end{align}

De la même façon, nous savons que $f^{(2)}(0)=P_n^{(2)}(0)$. Ainsi:

\begin{align}
\begin{split}
f^{(2)}(0)&=P^{(2)}_n(0)\\
f^{(2)}(0)&=2\cdot 1a_2+3\cdot 2a_3(0)+\ldots+(n-1)(n-2)a_{n-1}(0)^{n-3}+n(n-1)a_n(0)^{n-2} \\
f^{(2)}(0)&=2\cdot 1a_2  \\
\dfrac{f^{(2)}(0)}{2\cdot 1}&=a_2
\end{split}
\end{align}

D'une manière générale, nous trouvons:

\begin{align}
\begin{split}
a_k &= \dfrac{1}{k\cdot (k-1)\cdot ...\cdot 3\cdot 2\cdot 1}f^{(k)}(0) \\
&= \dfrac{f^{(k)}(0)}{k!}
\end{split}
\end{align}

```{remark, name = "Factorielle"}
La factorielle d'un nombre entier $k$ positif, notée $k!$, est égale à:
\begin{equation*}
k! = k(k-1)(k-2)\cdot\ldots\cdot 3\cdot 2\cdot 1
\end{equation*}
Et par définition $0!=1$.
```

Nous obtenons donc une équation pour déterminer le polynôme de MacLaurin d'une fonction.

```{definition, name = "Polynôme de MacLaurin"}
Soit $f(x)$ une fonction dérivable au moins $n$ fois en $x=0$. Le __polynôme de MacLaurin__ de degré $n$, $P_n(x)$, est donné par:
\begin{align*}
P_n(x)&=\sum_{k=0}^n\dfrac{f^{(k)}(0)}{k!}x^k=f(0)+f^{(1)}(0)x+\dfrac{f^{(2)}(0)}{2!}x^2+...+\dfrac{f^{(n)}(0)}{n!}x^n
\end{align*}
```

```{example}
Trouvez les polynômes de MacLaurin de degrés 1, 2 et 3 de $f(x)=e^x$.
\vspace*{8cm}
```

```{example}
Trouvez les polynômes de MacLaurin de degrés 1, 2 et 3 de $f(x)=sin(x)$.
\vspace*{8cm}
```

### Les polynômes de Taylor

Les polynômes de Maclaurin utilisent l'évaluation des dérivées successives de la fonction $f(x)$ en $x=0$. Il est par contre possible de généraliser ces polynômes en évaluant les dérivées successives de la fonction $f(x)$ en $x=a$, avec  $a\in \text{dom} f$. C'est ce que nous appelons les polynômes de Taylor.

```{definition, name = "Polynôme de Taylor"}
Soit $f(x)$ une fonction dérivable au moins $n$ fois en $x=a$. Le __polynôme de Taylor__ de degré $n$, $P_n(x)$, est donné par:
\begin{align*}
P_n(x)&=\sum_{k=0}^n\dfrac{f^{(k)}(a)}{k!}(x-a)^k\\
&=f(a)+f^{(1)}(a)(x-a)+\dfrac{f^{(2)}(a)}{2!}(x-a)^2+...+\dfrac{f^{(n)}(a)}{n!}(x-a)^n
\end{align*}
```

```{example}
Trouvez le polynôme de Taylor de $f(x)=\ln(x)$ de degré $4$ autour de $x=1$.
\vspace*{8cm}
```

### Le reste de Taylor-Lagrange

Les polynômes de Taylor sont des approximations d'une fonction, ce qui signifie qu'une erreur est commise. Le théorème suivant nous permet de quantifier l'erreur commise, c'est-à-dire $f(x)-P_n(x)$.

```{theorem, name = "Le reste de Taylor-Lagrange"}
Soit $f(x)$ une fonction dérivable au moins $n+1$ fois sur l'intervalle $I=[a,x]$ (si $x>a$) ou $I=[x,a]$ (si $x<a$). L'erreur commise $E_n(x)$ par l'approximation de $f(x)$ par $P_n(x)$ est donnée par:
\begin{align*}
|f(x)-P_n(x)|=|E_n(x)|=\left\vert\dfrac{f^{(n+1)}(\xi(x))}{(n+1)!}(x-a)^{(n+1)}\right\vert
\end{align*}
avec $\xi(x)\in I$.
```
```{proof}
La démonstration est plus avancée que le niveau de ce livre.
```

Comme la valeur $\xi(x)$ est rarement connue, nous utiliserons plutôt une borne sur l'erreur:

\begin{align*}
	|E_n(x)|=|f(x)-P_n(x)|&=\left\vert\dfrac{f^{(n+1)}(\xi(x))}{(n+1)!}(x-a)^{n+1}\right\vert\\
	|f(x)-P_n(x)| &\leq \left\vert\dfrac{M}{(n+1)!}(x-a)^{n+1}\right\vert,
\end{align*}
où $M=\text{max}_{x\in I}\left\vert f^{(n+1)}(x) \right\vert$.

```{example}
Déterminez $|E_n(x)|$ lorsque vous utilisez le polynôme de MacLaurin de degré $3$ de $f(x)=e^x$ sur l'intervalle $[0,2]$. __Astuce__: supposez que $e<3$.
\vspace*{10cm}
```

```{example}
Lorsque nous demandons à la calculatrice d'évaluer le nombre $e$, elle nous le donne avec une précision de $10^{-8}$, c'est-à-dire que l'erreur est inférieure à $10^{-8}$. Quel devrait être le degré du polynôme de MacLaurin pour $f(x)=e^x$ nécessaire pour obtenir cette précision? __Astuce__: supposez que $e<3$.
\vspace*{10cm}
```

```{example}
Répondez aux questions suivantes:
  
 a) Approximez $f(x)=\sqrt[3]{x}$ par un polynôme de Taylor de degré 2 en $a=8$.
 a) Estimez l'erreur faite lorsque $7\leq x \leq 9$.

\vspace*{10cm}
```

```{example}
Quelle est l'erreur maximale possible si on utilise l'approximation $\sin(x)=x-\dfrac{x^3}{3!}+\dfrac{x^5}{5!}$ lorsque $-0,3\leq x \leq 0,3$? Utilisez l'approximation pour estimer $\sin(12^{\circ})$ avec six (6) décimales exactes.
\vspace*{10cm}
```

## Les séries de Taylor

Nous avons vu que l'approximation d'une fonction par un polynôme est meilleure lorsque le degré de ce polynôme est élevé. Dans cette section, nous verrons que lorsque le degré du polynôme tend vers l'infini, nous obtenons une série de Taylor.

```{definition, name = "Série de Taylor"}
Soit $f(x)$ une fonction infiniment dérivable en $x=a$. La série de Taylor de $f(x)$ autour de $x=a$ est donnée par:
\begin{align*}
\lim_{n\to \infty}\sum_{k=0}^{n}\dfrac{f^{(k)}(a)}{k!}(x-a)^k	&= \sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k \\
	&=f(a)+f^{(1)}(a)(x-a)+\dfrac{f^{(2)}(a)}{2!}(x-a)^2+\ldots +\dfrac{f^{(n)}(a)}{n!}(x-a)^n+\ldots
\end{align*}
Dans le cas où $a=0$, nous parlons également de série de MacLaurin.
```

```{example}
Déterminez la série de MacLaurin de $f(x)=e^x$.
\vspace*{10cm}
```

```{example}
Déterminez la série de MacLaurin de $f(x)=\dfrac{1}{1-x}$.
\vspace*{10cm}
```

```{example}
Déterminez la série de MacLaurin de $f(x)=\ln(1+x)$.
\vspace*{10cm}
```

```{example}
Déterminez la série de MacLaurin de $f(x)=(1+x)^k$ où $k\in\mathbb{R}$.
\vspace*{10cm}
```

Ces exemples nous amènent à nous demander si une fonction $f(x)$ est égale à sa série de Taylor, et si c'est le cas, pour quelles valeurs de $x$. Nous savons que:
\begin{align*}
f(x)&=P_n(x)+E_n(x)\\
\lim_{n\to \infty}f(x)&=\lim_{n\to \infty}(P_n(x)+E_n(x))\quad\text{En prenant la limite de chaque côté}\\
f(x)&=\lim_{n\to \infty}(P_n(x))+\lim_{n\to \infty}(E_n(x))\\
f(x)&=\sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k+\lim_{n\to \infty}(E_n(x))
\end{align*}

Ainsi, pour que $f(x)=\sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k$, il faut que $\lim_{n\to \infty}E_n(x)=0$. Ce qui signifie que l'erreur tend vers zéro lorsque le degré du polynôme de Taylor tend vers l'infini.

De plus, il faut que la série converge, c'est-à-dire que:
\begin{align*}
\lim_{n\to \infty}\sum_{k=0}^{n}\dfrac{f^{(k)}(a)}{k!}(x-a)^k
\end{align*}
nous donne une valeur finie. Puisque la limite dépend de $x$, il faudra trouver les valeurs de $x$ qui font que la série converge. Ces valeurs forment l'__intervalle de convergence__ de la série.

```{theorem}
Soit $f(x)$ une fonction infiniment dérivable en $x=a$. Si $\lim_{n\to\infty}E_n(x)$, alors:
\begin{align*}
f(x)=\sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k
\end{align*}
si $x$ est dans l'intervalle de convergence.
```

```{theorem, name = "Le critère généralisé de d'Alembert"}
Soit une série de la forme $\sum_{k=0}^{\infty}c_k$ et soit $L=\lim_{k\to\infty}\left\vert\dfrac{c_{k+1}}{c_k}\right\vert$.

 - Si $L<1$, alors la série converge.
 - Si $L>1$, alors la série diverge.
 - Si $L=1$, alors on ne peut rien conclure.

```

```{example}
Déterminez l'intervalle de convergence de la série de MacLaurin de $f(x)=e^x$.
\vspace*{10cm}
```

```{example}
Déterminez l'intervalle de convergence de la série de MacLaurin de $f(x)=\dfrac{1}{1-x}$.
\vspace*{10cm}
```

```{example}
Déterminez l'intervalle de convergence de la série $\sum_{k=0}^{\infty} k! x^k$.
\vspace*{10cm}
```

```{example}
Déterminez l'intervalle de convergence de la série $\sum_{n=1}^{\infty} \dfrac{(x-3)^n}{n}$.
\vspace*{10cm}
```

```{example}
La fonction de Bessel d'ordre 0, $J_0(x)=\sum_{n=0}^{\infty}\dfrac{(-1)^n x^{2n}}{2^{2n}(n!)^2}$ est solution de l'équation différentielle suivante $x^2\dfrac{d^2y}{dx^2}+x\dfrac{dy}{dx}+x^2y=0$ qui est utile lorsque nous étudions les modes de vibrations d'une membrane circulaire. Pour plus d'informations, [Wikipedia: Vibrations of a circular membrane](https://en.wikipedia.org/wiki/Vibrations_of_a_circular_membrane). Trouvez l'intervalle de convergence de $J_0(x)$.
\vspace*{10cm}
```

### L'obtention de séries de Taylor à partir de séries connues.

Il est souvent plus simple de trouver une série de Taylor, à partir d'une série de Taylor déjà connue. La proposition \@ref(prp:taylor-usuelles) contient la liste des séries de Taylor usuelles.

```{proposition, name = "Une liste des séries de Taylor des fonctions usuelles", label = "taylor-usuelles"}
Voici une liste des séries de Taylor des fonctions usuelles.

 - $e^x=\sum_{k=0}^{\infty} \dfrac{x^k}{k!}$, pour tout $x\in\mathbb{R}$
 - $\ln(1+x)=\sum_{k=1}^{\infty} \dfrac{(-1)^{k+1}x^k}{k}$, pour tout $x\in ]-1,\ 1]$
 - $\dfrac{1}{1-x}=\sum_{k=1}^{\infty} x^k$, pour tout $x\in ]-1,\ 1[$
 - $(a+x)^n=\sum_{k=0}^{n}\dfrac{n!}{k!(n-k)!}a^{n-k}x^k$, où $n\in\mathbb{N}$, pour tout $x\in\mathbb{R}$
 - $(1+x)^p=\sum_{k=0}^{n}\dfrac{p(p-1)(p-2)\ldots(p-k+1)}{k!}x^k$, où $p\in\mathbb{R}\setminus\mathbb{N}$, pour tout $x\in ]-1,\ 1]$
 - $\sin(x)=\sum_{k=0}^{\infty} \dfrac{(-1)^kx^{2k+1}}{(2k+1)!}$, pour tout $x\in\mathbb{R}$
 - $\cos(x)=\sum_{k=0}^{\infty} \dfrac{(-1)^kx^{2k}}{(2k)!}$, pour tout $x\in\mathbb{R}$
 - $\text{Arctan}(x)=\sum_{k=0}^{\infty} \dfrac{(-1)^kx^{2k+1}}{2k+1}$, pour tout $x\in [-1,\ 1]$


```

Pour obtenir des séries de Taylor, les opérations suivantes sont possibles:

 - Changement de variables
 - Addition et soustraction de séries de Taylor
 - Multiplication de séries de Taylor
 - Division de séries de Taylor
 - Dérivation de séries de Taylor
 - Intégration de séries de Taylor
 
#### Changement de variables

```{example}
Trouvez la série de Taylor de $f(x)=e^{-x^2}$.
```
\vspace*{10cm}

#### Addition et soustraction

```{example}
Trouvez la limite $\lim_{x\to 0} \dfrac{e^x-1-x}{x^2}$ en trouvant au préalable la série de MacLaurin de $e^x-1-x$.
```
\vspace*{10cm}

```{example}
Montrez que $e^{ix}=\cos(x)+i\sin(x)$.
```
\vspace*{10cm}

#### Multiplication

```{example}
Trouvez les trois premiers termes de la série de Maclaurin de $e^x\sin(x)$.
```
\vspace*{10cm}

#### Division

```{example}
Trouvez les trois premiers termes de la série de Maclaurin de $\tan(x)$.
```
\vspace*{10cm}

#### Dérivation

```{example}
Trouvez la série de Maclaurin de $\dfrac{1}{1+x}$ en dérivant la série de Maclaurin de $\ln(1+x)$.
```
\vspace*{10cm}

#### Intégration

```{example}
Trouvez la série de Maclaurin de $\text{Arctan}(x)$ en intégrant la série de MacLaurin de $\dfrac{1}{1+x^2}=\sum_{k=0}^{\infty}(-1)^kx^{2k}$.
```
\vspace*{10cm}

## Applications

```{example}
À partir de la deuxième loi de Newton, nous pouvons montrer que l'angle $\theta$ que fait un pendule par rapport à la verticale  en fonction du temps, suit l'équation différentielle $\dfrac{d^2\theta}{dt^2}+\frac{g}{l}\sin(\theta)=0$ où $g$ est la constante gravitationnelle et $l$ la longueur du pendule. Malheureusement, il n'existe pas de solutions exactes pour cette équation différentielle. Par contre, il existe une méthode de résolution pour les équations différentielle de la forme $\dfrac{d^2y}{dt^2}+ky=0$. Écrivez l'équation du pendule sous la forme résoluble.
```
\vspace*{10cm}

```{example}
Soit un disque uniformément chargé de rayon $R$. Le potentiel électrique ressenti au point $P$ situé à une distance $d$ sur une droite perpendiculaire au disque et passant par son centre est donné par $V=2\pi k_e \sigma (\sqrt{d^2+R^2}-d)$. La constante $k_e$ représente la perméabilité du vide et la constante $\sigma$ la charge surfacique. Montrez que si $d$ est très grand par rapport à $R$ alors le potentiel électrique est $V \approx \dfrac{\pi k_e \sigma R^2}{d}$.
```
\vspace*{10cm}

```{example}
Soit  deux charges équivalentes $Q$ et $-Q$ se trouvant à une distance $r$
l'une de l'autre. Le champ électrique $E$ ressenti au point $P$, qui est à une distance $R$ de la charge $Q$ et de $R+r$ de la charge $-Q$, est donné par $E=\dfrac{Q}{R^2}-\dfrac{Q}{(R+r)^2}$. Montrez que lorsque $R$ est grand, le champ électrique est approximativement proportionnel à $\frac{1}{R^3}$.
```
\vspace*{10cm}

```{example}
Soit un corps de masse $m$ situé à une distance $h$ de la surface de la Terre. La force gravitationnelle $F$ agissant sur ce corps est donnée par $F=\dfrac{mgR^2}{(R+h)^2}$ où $g$ est l'accélération gravitationnelle et $R$ le rayon de la terre. Montrez que lorsque $h$ est petit par rapport à $R$, la formule précédente devient $F\approx mg$.
```
\vspace*{10cm}

```{example}
Les équations de Bessel sont données par $x^2\dfrac{d^2y}{dx^2}+x\dfrac{dy}{dx}+(x^2-n^2)y=0$ où $n\in\mathbb{N}$. Utilisez les séries de puissances pour trouver la solution de l'équation différentielle précédente lorsque $n=0$.
```
\vspace*{20cm}

```{example}
Soit $f(x)=x\cos(2x)$. Trouvez $f^{(99)}(0)$ et $f^{(100)}(0)$.
```
\vspace*{10cm}

```{example}
Soit $f(x)=x^2e^{-x}$. Trouvez $f^{(100)}(0)$.
```
\vspace*{10cm}

```{example}
Soit $g(x)=x\ln(1+(2x)^2)$. Trouvez $g^{(51)}(0)$.
```
\vspace*{10cm}

## GeoGebra {#geogebra-taylor}

<script type="text/javascript" src="https://cdn.geogebra.org/apps/deployggb.js"></script>
<script type="text/javascript">
var parameters = {
"appName":"graphing",
"material_id":"jg2qjmar",
"width":800,
"height":600,
"showToolBar":true,
"borderColor":null,
"showMenuBar":true,
"showFullscreenButton":true,
"enableShiftDragZoom":true};

var applet = new GGBApplet(parameters, 'applet_container');
window.onload = function() { applet.inject('applet_container'); updateHelp('AG');}
</script>
<div id="applet_container"></div>


\newpage
## Pages supplémentaires

Des pages blanches supplémentaires pour ajouter, potentiellement, de nouveaux exemples et exercices.

<!-- Code pour insérer des pages blanches dans le document pdf pour des exemples supplémentaires. -->

\multido{\i=1+1}{4}{
\newpage
\mbox{}
}


<!--chapter:end:01-taylor.Rmd-->

# Les équations différentielles ordinaires {#edo}

Vous trouverez à la section \@ref(geogebra-equations-diff) une application [GeoGebra](https://www.geogebra.org/?lang=fr) vous permettant de visualiser les solutions d'une équation différentielle homogène d'ordre 2 à coefficients constants. À noter que cette application n'est disponible que dans la version en ligne de ce document.

## Introduction

Les équations différentielles sont à la base de la modélisation de divers phénomènes physiques, statistiques, chimiques, biologiques ou économiques, par exemple. Nous n'étudierons pas en détail comment obtenir ces équations différentielles mais nous verrons comment résoudre trois types d'équations différentielles différents.

Nous étudierons les types suivants:

 - Les équations différentielles à variables séparables
 - Les équations différentielles linéaires
 - Les équations différentielles à coefficients constants d'ordre 2

```{definition, name = "Équation différentielle ordinaire"}
Une __équation différentielle ordinaire__ est une équation de la forme:
\begin{align*}
F(t, y, y^{(1)}, y^{(2)},\ldots, y^{(n)})=0
\end{align*}
où $y$ est une fonction inconnue de $t$ et les $y^{(k)}$ sont les dérivées k-ièmes de $y$.
```

```{example}
Voici quelques exemples d'équations différentielles:

 - $\dfrac{dy}{dt}=2ty$
 - $(y^{(5)})^3+8ty^{(1)}+12y=1$
 - $y''+by'+ky=\sin(\omega x)$

```

```{definition, name = "L'ordre d'une équation différentielle"}
L'__ordre__ d'une équation différentielle est l'entier représentant l'ordre de la dérivée la plus élevée de la fonction inconnue apparaissant dans l'équation différentielle.
```

```{example}
Voici quelques exemples d'ordre de diverses équations différentielles:

 - $\dfrac{dy}{dt}=2ty$, ordre de 1
 - $(y^{(5)})^3+8ty^{(1)}+12y=1$, ordre de 5
 - $y''+by'+ky=\sin(\omega x)$, ordre de 2

```

```{definition, name = "Solution d'une équation différentielle"}
Une fonction (ou une équation) est une __solution d'une équation différentielle__ si, en la remplaçant ainsi que ses dérivées dans l'équation différentielle, l'égalité est vérifiée.
```

```{example}
Vérifiez que $y(x)=e^{2x}$ est une solution de l'équation différentielle $\dfrac{d^2y}{dx^2}-3\dfrac{dy}{dx}+2y=0$.
```
\vspace*{5cm}

```{definition, name = "Solution générale ou famille de solutions d'une équation différentielle"}
La __solution générale__ ou __famille de solutions__ d'une équation différentielle est l'ensemble de toutes les fonctions qui sont des solutions de l'équation différentielle.
```

```{example}
Montrez que $y(t)=t^2+C$ où $C\in\mathbb{R}$ est la solution générale de l'équation différentielle $\dfrac{dx}{dt}=2t$.
```
\vspace*{5cm}

```{definition, name = "Condition initiale et solution particulière d'une équation différentielle"}
Une __condition initiale__ d'une équation différentielle est un point $(x_0,y_0)$ par lequel passe la solution, où $x_0$ et $y_0\in\mathbb{R}$. Une solution de l'équation différentielle qui vérifie la condition initiale est appelée __solution particulière__ de l'équation différentielle.
```

```{remark}
Lorsque qu'une équation différentielle est d'ordre $n$, nous aurons besoin de $n$ conditions initiales pour trouver la solution particulière.
```

## Les équations différentielles à variables séparables

```{definition, name = "Équation différentielle à variables séparables"}
Une __équation différentielle à variables séparables__ est une équation différentielle qui peut s'écrire sous la forme $M(y)dy=N(x)dx$.
```

Pour trouver la solution d'une équation différentielle à variables séparables, il faut:

 - Mettre l'équation sous la forme différentielle, c'est-à-dire placer les différentielles au __numérateur__.
 - Séparer les variables en se basant sur les différentielles.
 - Intégrer de chaque côté de l'égalité, c'est-à-dire $\int M(y)dy=\int N(x)dx$


```{example}
Résolvez l'équation différentielle suivante: $\cos(y)\dfrac{dy}{dt}=t^2$.
```
\vspace*{8cm}


```{remark}
Lorsque vous trouvez la solution d'une équation différentielle, il n'est pas toujours possible d'obtenir une équation explicite (c'est-à-dire une équation où la variable dépendante est isolée). 
```

```{example}
Trouvez la solution de l'équation différentielle $x+yy'=0$ passant par le point $(3,0)$.
```
\vspace*{8cm}

```{example, name = "Modèle de Hill-Keller"}
Le modèle de Hill-Keller permet de modéliser la course d'un coureur pour de courtes distances, par exemple le 100 m ou le 200 m. Si $F$ est une constante qui correspond à la force du coureur et $\tau$ est une constante représentant les forces de frottement du coureur, l'équation du modèle est donnée par: $\dfrac{dv}{dt}=F-\dfrac{v}{\tau}$. Trouvez la vitesse d'un coureur en fonction du temps si au temps initial la vitesse du coureur est nulle.
```
\vspace*{10cm}

```{example, name = "La tractrice"}
Vous avez une laisse rigide de longueur $a$. Vous vous trouvez au point $(0,0)$ et votre chien se trouve au point $(a,0)$. Vous vous dirigez dans la direction de l'axe des $y$ positifs. L'équation différentielle qui permet de trouver le parcours de votre chien est $\dfrac{dy}{dx}=-\dfrac{\sqrt{a^2-x^2}}{x}$. Trouvez la solution de l'équation différentielle précédente.
```
```{r,echo=FALSE,fig.align="center",out.width = "75%"}
knitr::include_graphics("resources/images/latex/tractrice.png")
```
\vspace*{10cm}

```{example}
Trouvez les trajectoires orthogonales de la famille $x=ky^2$.
```
\vspace*{8cm}

```{example}
Trouvez les trajectoires orthogonales de la famille $y=ke^x$.
```
\vspace*{8cm}

```{example, label = "parachutiste"}
Soit un parachutiste qui tombe sous l'effet de la gravité avec une résistance de l'air proportionnelle à sa vitesse. L'équation différentielle de cette situation est : $\dfrac{dv}{dt}+\dfrac{kv}{m}=g$ où $m$, $g$ et $k$  sont des constantes positives. Trouvez la solution de l'équation différentielle précédente.
```
\vspace*{8cm}

```{example}
La loi de refroidissement de Newton dit que le taux de variation de la température $T$ d'un objet est 
proportionnel à la différence entre la température de cet objet et la température ambiante (notée $T_A$).
Trouvez l'équation différentielle décrivant le phénomène et trouvez $T$ en fonction du temps.
```
\vspace*{8cm}

## Les équations différentielles linéaires

```{definition, name = "Équation différentielle linéaire"}
Une __équation différentielle linéaire__ est de la forme:
\begin{align*}
\dfrac{dy}{dt}+P(t)y=Q(t)
\end{align*}
où $P(t)$ et $Q(t)$ sont des fonctions qui ne doivent dépendre que de la variable indépendante.
```

```{example}
Voici quelques exemples d'équations différentielles linéaires:

 - $y'+t^2y=t^3$
 - $x^3y'-x^4y=1$ (Aprés division par $x^2$)
 - $y'=y$
 
 
```


Pour être en mesure de résoudre ce type d'équations différentielles, nous devrons tout d'abord utiliser une astuce.

Posons $\mu(t)$ une fonction inconnue. Nous avons donc:
\begin{align*}
\dfrac{d}{dt}[\mu y] &= \mu\dfrac{dy}{dt}+y\dfrac{d\mu}{dt} \\
&= \mu\left(Q(t)-P(t)y\right) + y\dfrac{d\mu}{dt} \qquad \text{car EDO linéaire}\\
&= \mu Q(t)-\mu P(t)y +y\dfrac{d\mu}{dt} \\
&= \mu Q(t)+y\left(\underbrace{\dfrac{d\mu}{dt}-\mu P(t)}_{\text{posons égal à 0}}\right)
\end{align*}

Ainsi:
\begin{align*}
\dfrac{d}{dt}[\mu y] &= \mu Q(t) \\
\mu y &= \int \mu Q(t) \ dt\\
y &= \dfrac{1}{\mu} \int \mu Q(t) \ dt
\end{align*}

Pour pouvoir résoudre l'intégrale précédente, nous avons besoin de connaître $\mu$ et nous savons que:
\begin{align*}
\dfrac{d\mu}{dt}-\mu P(t) &= 0 \\
\dfrac{d\mu}{dt} &= \mu P(t) \\
\int\dfrac{1}{\mu}d\mu &= \int P(t)dt \\
\ln |\mu| &= \int P(t)dt \\
\mu &= e^{\int P(t)dt}
\end{align*}

Pour résoudre une équation différentielle linéaire, il faut donc:

 1. Trouver $\mu$: $\mu = e^{\int P(t)dt}$
 1. Trouver $y$: $y = \dfrac{1}{\mu} \int \mu Q(t) \ dt$
 
```{example}
Trouvez la solution générale de $y'+3\dfrac{y}{t}=1$.
```
\vspace*{8cm}

```{example}
Trouvez la solution générale de $x^2y'+xy=1$ où $x>0$ et $y(1)=2$.
```
\vspace*{8cm}

```{example}
Trouvez la solution générale de $ty'+2y=t^2-t+1$.
```
\vspace*{8cm}

```{example}
Trouvez la solution générale de $\cos(x)y'+\sin(x)y=2\cos(x)^3\sin(x)-1$.
```
\vspace*{8cm}

```{example}
Résolvez l'équation différentielle du parachutiste, comme vu à l'exemple \@ref(exm:parachutiste), en utilisant les équations différentielles linéaires. L'équation différentielle est donnée par : $\dfrac{dv}{dt}+\dfrac{kv}{m}=g$.
```
\vspace*{8cm}

### Problèmes de mélange

Dans des problèmes de mélange, nous cherchons $Q(t)$ qui représente la quantité d'une substance en fonction du temps. L'équation différentielle de base de ce genre de problèmes est:

> Taux de variation de $Q(t)$ = Taux d'entrée de $Q(t)$ - Taux de sortie de $Q(t)$

```{example}
Une cuve contient 10 L d'eau salée dans laquelle 2 kg de sel sont dissout. De l'eau salée contenant 1 kg de sel par litre entre dans la cuve à un débit constant de 3 L/min, et l'eau mélangée est vidée à un taux de 4 L/min. Trouvez la quantité de sel en fonction du temps $Q(t)$.
```
\vspace*{10cm}

```{example}
Une cuve contient 40 L d'eau pure. De la saumure avec 3 kg de sel par litre entre dans la cuve à un débit constant de 2 L/min, et la mixture mélangée s'écoule à un débit constant de 3 L/min.

 a) Trouvez la quantité de sel en fonction du temps $Q(t)$.
 b) Quelle est la quantité de sel lorsqu'il reste 20 L dans la cuve?
 
 
```
\vspace*{10cm}

### Inverser la dérivée

Pour obtenir une équation différentielle linéaire, il faut parfois étudier l'inverse de votre dérivée.

> Plutôt que d'étudier $\dfrac{dy}{dx}$, nous pouvons étudier $\dfrac{dx}{dy}$.

```{example}
Trouvez la solution de l'équation différentielle $(e^y-2xy)\dfrac{dy}{dx}=y^2$.
```
\vspace*{8cm}

```{example}
Trouvez les familles de courbes orthogonales à $y^2=ce^x+x+1$ où $c\in\mathbb{R}$.
```
\vspace*{8cm}

## Les équations différentielles à coefficients constants d'ordre 2

### Quelques rappels concernant les nombres complexes

```{definition, name = "Nombre complexe"}
Un nombre complexe $z$ s'écrit sous la forme $z=a+bi$, où $a,b \in \mathbb{R}$ et tel que $i^2=-1$. 

Nous disons que $a$ est la partie réelle de $z$ et $b$ est la partie imaginaire de $z$.

L'ensemble des nombres complexes est noté $\mathbb{C}$.

Nous pouvons également écrire $z$ sous une form dite polaire qui est $z=r(\cos(\theta)+i\sin(\theta))$, où $r=\sqrt{a^2+b^2}$ et $\theta=\text{Arctan}\left(\dfrac{b}{a}\right)$.
```

La figure \@ref(fig:nombrescomplexes) permet de représenter un nombre complexe de façon géométrique.

```{r,echo=FALSE,fig.align="center",label="nombrescomplexes",out.width="50%",fig.cap="Représentation d'un nombre complexe"}
knitr::include_graphics("resources/images/latex/nombrescomplexes.png")
```

```{theorem, name = "L'identité d'Euler", label = "identite-euler"}
Soit le nombre complexe écrit sous la forme $z=r(\cos(\theta)+i\sin(\theta))$. Alors ce nombre peut s'écrire de la manière suivante: $z=re^{i\theta}$.
```
```{proof}
La démonstration est laissée à l'étudiante ou l'étudiant. __Astuce__: Il faut utiliser les séries de MacLaurin de $e^x$, $\sin(x)$ et $\cos(x)$.
```

```{corollary, label = "sin-cos-ei"}
Nous avons:
\begin{align*}
\cos(\theta) &= \dfrac{e^{i\theta}+e^{-i\theta}}{2} \\
\sin(\theta) &= \dfrac{e^{i\theta}-e^{-i\theta}}{2i}
\end{align*}

```
```{proof}
Pour démontrer ce résultat, nous utiliserons le théorème \@ref(thm:identite-euler). Nous avons:
\begin{align}
e^{i\theta} &= \cos(\theta)+i\sin(\theta)(\#eq:eplus) \\
e^{-i\theta} &= \cos(-\theta)+i\sin(-\theta) \notag \\
&= \cos(\theta)-i\sin(\theta)(\#eq:emoins)
\end{align}

Si nous additions les équations \@ref(eq:eplus) et \@ref(eq:emoins):
\begin{align*}
e^{i\theta}+e^{-i\theta} &= \cos(\theta)+i\sin(\theta)+\cos(\theta)-i\sin(\theta) \\
&= 2\cos(\theta) \\
\cos(\theta) &= \dfrac{e^{i\theta}+e^{-i\theta}}{2}
\end{align*}

Si nous faisons la différence entre les équations \@ref(eq:eplus) et \@ref(eq:emoins):
\begin{align*}
e^{i\theta}-e^{-i\theta} &= \cos(\theta)+i\sin(\theta)-(\cos(\theta)-i\sin(\theta)) \\
&= 2i\sin(\theta) \\
\sin(\theta) &= \dfrac{e^{i\theta}-e^{-i\theta}}{2i}
\end{align*}


```

### Les équations différentielles homogènes à coefficients constants d'ordre 2

```{definition, name = "Équation différentielle homogène à coefficients constants d'ordre 2"}
Une __équation différentielle homogène à coefficients constants d'ordre 2__ est une équation différentielle de la forme:
\begin{align}
a\dfrac{d^2y}{dx^2}+b\dfrac{dy}{dx}+cy &= 0 (\#eq:homogene2)
\end{align}
où $a,b,c \in \mathbb{R}$ et $a\neq 0$.
```

> Le terme *homogène* indique que le membre de droite de l'équation \@ref(eq:homogene2) est nul. Nous traiterons le cas à la section \@ref(non-homogene-2).

Avant de résoudre ce type d'équations différentielles, la prochaine proposition sera cruciale.

```{proposition, label = "combinaison-lineaire-solution"}
Si $y_1(x)$ et $y_2(x)$ sont deux solutions de l'équation \@ref(eq:homogene2), alors $y(x)=C_1y_1(x)+C_2y_2(x)$, où $C_1,C_2\in\mathbb{R}$, est aussi une solution de l'équation \@ref(eq:homogene2).
```
```{proof}
Nous avons que:
\begin{align*}
ay_1''+by_1'+cy_1 &= 0 \\
ay_2''+by_2'+cy_2 &= 0
\end{align*}
car $y_1$ et $y_2$ sont des solutions de \@ref(eq:homogene2). Nous avons que:
\begin{align*}
y &= C_1y_1+C_2y_2 \\
y' &= C_1y_1'+C_2y_2' \\
y'' &= C_1y_1''+C_2y_2'' \\
\end{align*}
Ainsi:
\begin{align*}
ay''+by'+cy &= a(C_1y_1''+C_2y_2'')+b(C_1y_1'+C_2y_2')+c(C_1y_1+C_2y_2) \\
&= C_1\underbrace{(ay_1''+by_1'+cy_1)}_{=\ 0}+C_2\underbrace{(ay_2''+by_2'+cy_2)}_{=\ 0} \\
&= 0
\end{align*}

```

> Une combinaison linéaire de solutions est aussi une solution.

Nous pouvons maintenant résoudre l'équation \@ref(eq:homogene2)  en supposant que la solution est de la forme $y=e^{rx}$, où $r$ est une constante qu'il nous reste à déterminer. 

> Pour résoudre une équation différentielle homogène d'ordre 2 à coefficients constants, il faut toujours poser la solution $y=e^{rx}$.

Nous avons donc:
\begin{align*}
y &= e^{rx} \\
y' &= re^{rx} \\
y'' &= r^2e^{rx}
\end{align*}

Nous substituons ces résultats dans l'équation \@ref(eq:homogene2):
\begin{align}
a\dfrac{d^2y}{dx^2}+b\dfrac{dy}{dx}+cy &= 0 \notag \\
ar^2e^{rx}+bre^{rx}+ce^{rx} &= 0 \notag \\
e^{rx}(ar^2+br+c) &= 0 \notag \\
ar^2+br+c &= 0(\#eq:quadratique)
\end{align}

L'équation \@ref(eq:quadratique) se nomme polynôme caractéristique de l'équation \@ref(eq:homogene2). Déterminer les valeurs de $r$ revient à trouver les racines du polynôme caractéristique et donc:
\begin{align*}
r_{1,2} &= \dfrac{-b\pm\sqrt{b^2-4ac}}{2a}
\end{align*}
Nous devrons étudier trois cas distincts qui dépendent du discriminant $b^2-4ac$.

#### Cas 1: $b^2-4ac>0$

Dans ce cas, le polynôme caractéristique fournit deux valeurs de $r$ __réelles__, que nous notons $r_1$ et $r_2$. Nous avons donc $y_1(x)=e^{r_1x}$ qui est une solution de \@ref(eq:homogene2) et également $y_2=e^{r_2x}$. Par la proposition \@ref(prp:combinaison-lineaire-solution), nous obtenons la solution générale:
\begin{align*}
y(x) &= C_1e^{r_1x}+C_2e^{r_2x}
\end{align*}
où $C_1,C_2\in\mathbb{R}$.

```{example}
Résolvez l'équation différentielle $y''+y'-6y=0$ avec comme conditions initiales $y(0)=0$ et $y'(0)=1$.
```
\vspace*{10cm}


#### Cas 2: $b^2-4ac<0$

Dans ce cas, le polynôme caractéristique fournit deux valeurs de $r$ __complexes__. Posons $\gamma=-\dfrac{b}{2a}$ et $\omega=\dfrac{\sqrt{4ac-b^2}}{2a}$ ce qui implique que $r_1=\gamma+\omega i$ et $r_2=\gamma -\omega i$. Nous avons donc deux solutions à l'équation \@ref(eq:homogene2), soit $y_1=e^{r_1x}=e^{(\gamma+\omega i)x}$ et $y_2=e^{r_2x}=e^{(\gamma-\omega i)x}$.

Puisque les solutions précédentes sont complexes, nous allons utiliser la proposition \@ref(prp:combinaison-lineaire-solution) et le corollaire \@ref(cor:sin-cos-ei) pour créer deux nouvelles solutions réelles:
\begin{align*}
y_3(x) &= \dfrac{y_1(x)+y_2(x)}{2} \\
&= \dfrac{e^{(\gamma+\omega i)x}+e^{(\gamma-\omega i)x}}{2} \\
&= e^{\gamma x}\left( \dfrac{e^{\omega i x}+e^{-\omega i x}}{2} \right) \\
&= e^{\gamma x}\cos(\omega x) \\
y_4(x) &= \dfrac{y_1(x)-y_2(x)}{2i} \\
&= \dfrac{e^{(\gamma+\omega i)x}-e^{(\gamma-\omega i)x}}{2i} \\
&= e^{\gamma x}\left( \dfrac{e^{\omega i x}-e^{-\omega i x}}{2i} \right) \\
&= e^{\gamma x}\sin(\omega x)
\end{align*}

D'où la solution générale de l'équation \@ref(eq:homogene2) est:
\begin{align*}
y(x) &= e^{\gamma x}\left( C_1\cos(\omega x)+C_2\sin(\omega x) \right)
\end{align*}

```{example}
Trouvez la solution de l'équation différentielle $y''+2y'+10y=0$ ayant comme conditions initiales $y(0)=0$ et $y'(0)=3$.
```
\vspace*{10cm}

#### Cas 3: $b^2-4ac=0$

Dans ce cas, nous n'obtenons qu'une seule valeur de $r=-\dfrac{b}{2a}$. Puisque nous n'avons qu'une seule solution, nous devons en trouver une autre pour être en mesure de construire une combinaison linéaire. Nous allons démontrer que $y_2(x)=xe^{rx}$ est aussi une solution de l'équation différentielle \@ref(eq:homogene2).
```{proof}
\begin{align*}
y_2 &= xe^{rx} \\
y_2' &= e^{rx}+rxe^{rx} \\
y_2'' &= re^{rx}+re^{rx}+r^2xe^{rx}
\end{align*}
Et donc:
\begin{align*}
ay'' +by' +cy &= 0 \\
a(2re^{rx}+r^2xe^{rx})+b(e^{rx}+rxe^{rx})+c(xe^{rx}) &= 0 \\
e^{rx}(2ar+ar^2x+b+brx+cx) &= 0 \\
e^{rx}(\underbrace{(ar^2+br+c)}_{=0}x+\underbrace{(2ar+b)}_{=0}) &= 0 
\end{align*}

```

La solution générale est donc de la forme:
\begin{align*}
y(x) &= C_1e^{rx}+C_2xe^{rx}
\end{align*}

```{example}
Trouvez la solution de l'équation différentielle $y''+2y'+y=0$.
```
\vspace*{5cm}

```{example}
Trouvez les solutions des équations différentielles suivantes:

  a) $y''-9y'+20y=0$
  a) $2y''-4y'+8y=0$
  a) $y''+6y'+9=0$


```
\vspace*{20cm}

### Les équations différentielles non homogènes à coefficients constants d'ordre 2 {#non-homogene-2}

```{definition, name = "Équation différentielle non homogène à coefficients constants d'ordre 2"}
Une __équation différentielle non homogène à coefficients constants d'ordre 2__ est une équation différentielle de la forme:
\begin{align}
a\dfrac{d^2y}{dx^2}+b\dfrac{dy}{dx}+cy &= F(x) (\#eq:nonhomogene2)
\end{align}
où $a,b,c \in \mathbb{R}$ et $a\neq 0$. De plus $F(x)$ est une fonction qui ne dépend que de la variable indépendante.
```

Pour résoudre ce type d'équations différentielles, nous aurons besoin du théorème suivant:

```{theorem}
Soit une équation différentielle de la forme:
\begin{align*}
a\dfrac{d^2y}{dx^2}+b\dfrac{dy}{dx}+cy &= F(x)
\end{align*}
La solution de cette équation différentielle est de la forme:
\begin{align*}
y(x) &= C_1y_1(x)+C_2y_2(x)+y_p
\end{align*}
où $y_1$ et $y_2$ sont les solutions de l'équation homogène associée à l'équation \@ref(eq:nonhomogene2), c'est-à-dire:
\begin{align*}
a\dfrac{d^2y}{dx^2}+b\dfrac{dy}{dx}+cy &= 0
\end{align*}
et $y_p$ est une solution particulière de l'équation non homogène.

```
```{proof}
La démonstration est laissée à l'étudiante ou à l'étudiant.
```

Nous verrons deux méthodes pour trouver $y_p$.

#### La méthode des coefficients indéterminés

Cette méthode consiste à étudier la nature de la fonction $F(x)$ et à supposer que $y_p$ est de même nature. La table \@ref(tab:coeff-indetermines) montre la forme de la solution particulière $y_p$ selon la nature de $F(x)$.

Table: (\#tab:coeff-indetermines) Les diverses formes de coefficients indéterminés.

|                        Forme de $F(x)$                       |               Forme de $y_p$               |
|:------------------------------------------------------------:|:------------------------------------------:|
|                     Polynôme de degré $n$                    | $y_p=a_nx^n+a_{n-1}x^{n-1}+\ldots+a_x+a_0$ |
| $F(x)$ possède un $\sin(\omega x)$ et/ou un $\cos(\omega x)$ |    $y_p=A\cos(\omega x)+B\sin(\omega x)$   |
|        $F(x)$ possède une exponentielle $e^{\alpha x}$       |             $y_p=A^{\alpha x}$             |

```{example}
Trouvez la solution générale de l'équation différentielle $y''+y'-6y=3x^2$.
```
\vspace*{10cm}

```{example}
Trouvez la solution générale de l'équation différentielle $y''+y'-6y=e^{4x}+\cos(3x)$.
```
\vspace*{10cm}

```{example}
Trouvez la solution générale de l'équation différentielle $y''+2y'+10y=\cos(2t)$ avec les conditions intiales $y(0)=-\frac{1}{2}$ et $y'(0)=4$.
```
\vspace*{15cm}


#### La méthode de variation des paramètres (ou méthode de Lagrange)

La méthode de variation des paramètres est souvent plus longue à utiliser que la méthode des coefficients indéterminés, par contre, elle est valide pour tous les types de fonctions $F(x)$.

Nous débutons en trouvant les solutions $y_1$ et $y_2$ de l'équation différentielle homogène associée à l'équation:
\begin{align*}
ay''+by'+cy=F(x)
\end{align*}

Supposons que la solution est de la forme :
\begin{align*}
y(x) &= \mu_1(x)y_1(x)+\mu_2(x)y_2(x)
\end{align*}
Afin d'alléger la notation, nous omettrons la dépendance en $x$. Nous cherchons donc $\mu_1$ et $\mu_2$. Avant de substituer dans l'équation différentielle, nous allons trouver les dérivées successives de $y$.
\begin{align*}
y' &= \mu_1y_1'+\mu_1'y_1+\mu_2'y_2+\mu_2y_2'
\end{align*}
Nous allons maintenant faire la supposition que $\mu_1'y_1+\mu_2'y_2=0$ et donc:
\begin{align*}
y' &= \mu_1y_1'+\mu_2y_2'
\end{align*}
Trouvons maintenant la dérivée seconde:
\begin{align*}
y' &= \mu_1'y_1'+\mu_1y_1''+\mu_2'y_2'+\mu_2y_2''
\end{align*}
Nous avons donc:
\begin{align*}
ay''+by'+cy &= F(x) \\
a(\mu_1'y_1'+\mu_1y_1''+\mu_2'y_2'+\mu_2y_2'')+b(\mu_1y_1'+\mu_2y_2')+c(\mu_1y_1+\mu_2y_2) &= F(x) \\
\mu_1\underbrace{(ay_1''+by_1'+cy_1)}_{=0}+\mu_2\underbrace{(ay_2''+by_2'+cy_2)}_{=0}+\mu_1'y_1'+\mu_2'y_2' &= F(x) \\
\mu_1'y_1'+\mu_2'y_2' &= F(x)
\end{align*}
Ainsi, pour déterminer $\mu_1$ et $\mu_2$, nous avons les deux équations suivantes:
\begin{align*}
\mu_1'y_1+\mu_2'y_2 &= 0 \\
\mu_1'y_1'+\mu_2'y_2' &= F(x)
\end{align*}
Nous pouvons utiliser la méthode de Cramer pour résoudre ce système d'équations linéaires:
\begin{align*}
\mu_1'&= \dfrac{
\begin{vmatrix}
0&y_2\\
F(x)&y_2'
\end{vmatrix}}{
\begin{vmatrix}
y_1 &y_2\\
y_1'&y_2'
\end{vmatrix}
}=-\dfrac{y_2F(x)}{W(y_1,y_2)}\\
\mu_2'&= \dfrac{
\begin{vmatrix}
y_1&0\\
y_1'&F(x)
\end{vmatrix}}{
\begin{vmatrix}
y_1 &y_2\\
y_1'&y_2'
\end{vmatrix}
}=\dfrac{y_1F(x)}{W(y_1,y_2)}
\end{align*}

```{definition,name="Wronskien"}
Nous appelons le __Wronskien__ de deux fonctions $y_1$ et $y_2$, le résultat suivant:
\begin{align*}
W(y_1,y_2)=\begin{vmatrix}
y_1 &y_2\\
y_1'&y_2'
\end{vmatrix}
\end{align*}

```

```{remark}
Le __Wronskien__ n'est jamais égal à zéro lorsque nous résolvons une équation différentielle car $y_1$ et $y_2$ sont choisies pour être linéairement indépendantes.
```

Nous pouvons maintenant trouver nos deux fonctions $\mu_1$ et $\mu_2$:
\begin{align*}
\mu_1&=-\int \dfrac{y_2(x)F(x)}{W(y_1,y_2)}dx\\
\mu_2&=\int \dfrac{y_1(x)F(x)}{W(y_1,y_2)}dx
\end{align*}

```{example}
Trouvez la solution particulière de l'équation différentielle $y''+y=\csc(x)$.
```
\vspace*{10cm}

```{example}
Trouvez les solutions des équations différentielles suivantes en utilisant les deux méthodes:

  - Méthode des coefficients indéterminés
  - Méthode de variation des paramètres

  a. $y''-2y'+y=2x$
  a. $y''-y'-6y=e^{-x}$
  
  
```

## Applications des équations différentielles du deuxième ordre à coefficients constants

Nous discuterons en particulier de l'oscillateur harmonique forcé. 

```{example, name="Oscillateur harmonique forcé"}
Soit un ressort de constante $k$ auquel nous attachons une masse $M$. Si le frottement est proportionnel à la vitesse de la masse et que celle-ci subit une force périodique, nous pouvons décrire le mouvement avec l'équation suivante:
\begin{align*}
\dfrac{d^2x}{dt^2}+\dfrac{c}{M}\dfrac{dx}{dt}+\dfrac{k}{M}x &= \dfrac{F_0}{M}\cos(\omega t)
\end{align*}
Nous pouvons réécrire l'équation précédente en introduisant les variables $b=\dfrac{c}{2M}$ et $a=\sqrt{\dfrac{k}{M}}$:
\begin{align*}
\dfrac{d^2x}{dt^2}+2b\dfrac{dx}{dt}+a^2x &= \dfrac{F_0}{M}\cos(\omega t)
\end{align*}
Ce changement nous simplifiera le travail.

  a. Trouvez la solution homogène de l'équation différentielle.
  a. Supposez que $b=0$, c'est-à-dire qu'il n'y a pas de frottement. Trouvez la solution particulière dans le cas où $a\neq \omega$. (Vous étudiez dans ce cas la situation des __battements__). Pour en savoir plus sur le phénomène de [battements](https://fr.wikipedia.org/wiki/Battement_(physique)).
  a. Supposez que $b=0$, c'est-à-dire qu'il n'y a pas de frottement. Trouvez la solution particulière dans le cas où $a =\omega$. (Vous étudiez dans ce cas la situation de __résonnance__) Pour voir en action le phénomène de résonnance, [Tacoma Narrows Bridge](https://www.youtube.com/watch?v=j-zczJXSxnw) .

```

## GeoGebra {#geogebra-equations-diff}

<script type="text/javascript" src="https://cdn.geogebra.org/apps/deployggb.js"></script>
<script type="text/javascript">
var parameters = {
"appName":"graphing",
"material_id":"vcv92e6s",
"width":800,
"height":600,
"showToolBar":true,
"borderColor":null,
"showMenuBar":true,
"showFullscreenButton":true,
"enableShiftDragZoom":true};

var applet = new GGBApplet(parameters, 'applet_container');
window.onload = function() { applet.inject('applet_container'); updateHelp('AG');}
</script>
<div id="applet_container"></div>

\newpage
## Pages supplémentaires

Des pages blanches supplémentaires pour ajouter, potentiellement, de nouveaux exemples et exercices.

<!-- Code pour insérer des pages blanches dans le document pdf pour des exemples supplémentaires. -->

\multido{\i=1+1}{4}{
\newpage
\mbox{}
}

<!--chapter:end:02-edo.Rmd-->

# Les coordonnées polaires {#coordpolaires}

Vous trouverez à la section \@ref(geogebra-polaire) une application [GeoGebra](https://www.geogebra.org/?lang=fr) vous permettant de visualiser des courbes en coordonnées polaires. À noter que cette application n'est disponible que dans la version en ligne de ce document.

## Introduction

Les coordonnées polaires sont un autre système pour décrire un point $P$ de $\mathbb{R}^2$. Les coordonnées cartésiennes associent à chaque point $P$ un couple $(x,y)$. Les coordonnées polaires consistent à décrire ce point $P$ avec le couple $(r,\theta)$, où $r$ est la longueur du segment de droite reliant l'origine au point $P$ et $\theta$ est l'angle entre ce segment de droite et l'axe des $x$ positifs. La figure \@ref(fig:coordpolaires) représente ce type de coordonnées.

```{r,echo=FALSE,fig.align="center",label="coordpolaires",out.width="50%",fig.cap="Coordonnées polaires d'un point $P$"}
knitr::include_graphics("resources/images/latex/coordpolaires.png")
```

Il est primordial de pouvoir convertir les coordonnées cartésiennes à des coordonnées polaires et vice-versa.

```{proposition,name="Coordonnées cartésiennes à coordonnées polaires"}
Soit un point $P$ en coordonnées cartésiennes $(x,y)$. La conversion en coordonnées polaires est:
\begin{align*}
r &= \sqrt{x^2+y^2} \\
\theta &= \text{Arctan}\left(\dfrac{y}{x}\right)
\end{align*}
  
```

```{proposition,name="Coordonnées polaires à coordonnées cartésiennes"}
Soit un point $P$ en coordonnées polaires $(r,\theta)$. La conversion en coordonnées cartésiennes est:
\begin{align*}
x &= r\cos(\theta) \\
y &= r\sin(\theta)
\end{align*}
  
```

```{remark}
Voici quelques remarques:

  1. L'origine, c'est-à-dire le point $(0,0)$ en coordonnées cartésiennes, que l'on appelle pôle, peut s'écrire $(0,\theta)$, et ce, pour toutes les valeurs de $\theta$ possibles. Ceci signifie qu'il n'existe pas de bijection[^1] entre les coordonnées cartésiennes et polaires. Par contre, si on enlève l'origine, il en existe une.
  1. Lorsque l'on fixe $\theta=\theta_0$, l'ensemble formé par $(r,\theta_0)$est une demi-droite. En acceptant que $r$ soit négatif, on obtient alors que $(r,\theta_0)$ forme une droite.
  1. Si $r>0$, alors $(-r,\theta_0)=(r,\theta_0+\pi)$.


```

[^1]: Une bijection est une fonction $f$ allant d'un ensemble $A$ à un ensemble $B$,
telle que pour tous les éléments de $B$, on associe une seule valeur de $A$. 

```{example}
Écrivez les points suivants en coordonnées polaires:
  
  a. $P_1=(1,1)$
  a. $P_2=(-\sqrt{3},1)$
  a. $P_3=(0,-2)$


```
\vspace*{10cm}

```{example}
Écrivez les points suivants en coordonnées cartésiennes:
  
  a. $(2,\pi/3)$
  a. $(3,3\pi/4)$
  
  
```
\vspace*{10cm}

```{example}
Écrivez l'équation de la perle de Sluze en coordonnées polaires, si $y^2=x(8-x)$.
```
\vspace*{6cm}

## Le graphique d'une équation polaire $r=f(\theta)$

Étudions maintenant comment représenter graphiquement des équations polaires de la forme $r=f(\theta)$. Nous généraliserons le tout pour des équations implicites de la forme $F(r,\theta)=0$.

```{example}
Dessinez la courbe $r=K$ où $K$ est une constante et $K>0$.
```
\vspace*{5cm}

```{example}
Dessinez la courbe $\theta=\dfrac{\pi}{4}$.
```
\vspace*{5cm}

Pour être en mesure de dessiner des relations en coordonnées polaires, nous aurons besoin d'une grille polaire.

```{definition,name="Grille polaire"}
Une grille polaire est une grille où nous traçons les courbes telles que $r$ est constant, c'est-à-dire des cercles centrés en $(0,0)$ et telles que $\theta$ est constante, c'est-à-dire les droites passant par l'origine et faisant un angle $\theta$ avec l'axe des $x$. 

Nous représentons habituellement les cercles de rayons $1$ à $5$ et les droites d'angles $\frac{\pi}{6}$ ($30^{\circ}$), $\frac{\pi}{4}$ ($45^{\circ}$) et $\frac{\pi}{3}$ ($60^{\circ}$).

Une grille polaire est représentée à la figure \@ref(fig:grillepolaire).
```

```{r,echo=FALSE,fig.align="center",label="grillepolaire",out.width="50%",fig.cap="Grille polaire"}
knitr::include_graphics("resources/images/latex/grillepolaire.png")
```

```{example}
Dessinez $r=1=\sin(2\theta)$.
```
```{r,echo=FALSE,fig.align="center",label="ex1courbepolaire",out.width="50%"}
knitr::include_graphics("resources/images/latex/ex1courbepolaire.png")
```

```{example}
Dessinez $r=1=\sin(\theta)$ pour $\theta\in [0,2\pi]$.
```
```{r,echo=FALSE,fig.align="center",label="ex2courbepolaire",out.width="50%"}
knitr::include_graphics("resources/images/latex/ex2courbepolaire.png")
```

## Tangente à une courbe polaire

Nous voulons maintenant déterminer les tangentes à des courbes polaires. Nous savons que $x=r\cos(\theta)$ et que $y=r\sin(\theta)$. Si $r=f(\theta)$ alors nous avons que $x=x(\theta)$ et $y=y(\theta)$, c'est-à-dire que $x$ et $y$ sont des fonctions de $\theta$.

```{theorem,name="Tangentes à une courbe polaire",label="tangente-polaire"}
Soit $x$ et $y$ deux fonctions de $\theta$. Si $r=f(\theta)$, nous avons:
\begin{align*}
\dfrac{dy}{dx} &= \dfrac{f'(\theta)\sin(\theta)+f(\theta)\cos(\theta)}{f'(\theta)\cos(\theta)-f(\theta)\sin(\theta)}
\end{align*}

```
```{proof}
Trouvons $\dfrac{dx}{d\theta}$ et $\dfrac{dy}{d\theta}$.
\begin{align*}
\dfrac{dx}{d\theta} &= \dfrac{d}{d\theta}\left[f(\theta)\cos(\theta)]\right] \\
&=  f'(\theta)\cos(\theta)-f(\theta)\sin(\theta) \\
\dfrac{dy}{d\theta} &= \dfrac{d}{d\theta}\left[f(\theta)\sin(\theta)]\right] \\
&=  f'(\theta)\sin(\theta)+f(\theta)\cos(\theta) 
\end{align*}
Ainsi,
\begin{align*}
\dfrac{dy}{dx} &= \dfrac{\dfrac{dy}{d\theta}}{\dfrac{dx}{d\theta}} \\
&= \dfrac{f'(\theta)\sin(\theta)+f(\theta)\cos(\theta)}{f'(\theta)\cos(\theta)-f(\theta)\sin(\theta)}
\end{align*}

```

Nous avons maintenant une formule pour déterminer la pente de la droite tangente.

```{example}
Trouvez l'équation de la droite tangente en $\theta=\frac{\pi}{2}$ de $r=1+\sin(2\theta)$.
```
\vspace*{8cm}

```{example}
Soit l'équation $r=2\cos(\theta)$.

  a. Trouvez la dérivée $\dfrac{dy}{dx}$.
  a. Évaluez $\left.\dfrac{dy}{dx}\right|_{\theta=\frac{\pi}{4}}$.
  a. Évaluez $\left.\dfrac{dy}{dx}\right|_{\theta=\frac{\pi}{3}}$.

```
\vspace*{10cm}

```{example}
Trouvez la dérivée de la rose de Ghandi, $r=\cos\left(\dfrac{3\theta}{2}\right)$.
```
\vspace*{6cm}

## Aire d'une région

Nous voulons maintenant trouver une formule afin de calculer l'aire d'une région formée par une courbe définie par $r=f(\theta)$ avec $\theta_a\leq \theta \leq \theta_b$.

Rappelons que l'aire $A$ d'un secteur de cercle de rayon $r$ est donnée par $A=\dfrac{1}{2}r^2\theta$.

La figure \@ref(fig:airepolaire1) représente la surface que nous désirons trouver.

```{r,echo=FALSE,fig.align="center",label="airepolaire1",out.width="50%",fig.cap="Aire d'une courbe polaire"}
knitr::include_graphics("resources/images/latex/airepolaire1.png")
```

Divisons l'intervalle $\theta_a\leq \theta \leq \theta_b$ en $N$ partitions de longueur $\Delta \theta_i=\theta_i-\theta_{i-1}$ pour $i=1,\ldots,N$. L'ensemble
\begin{align*}
\{\theta_0=\theta_a,\theta_1,...,\theta_{N-1},\theta_{N}=\theta_b\}
\end{align*}
est appelée partition de $\theta_a\leq \theta \leq \theta_b$. L'aire de chacun de ces secteurs peut être approchée par:
\begin{align*}
A_i\approx \dfrac{1}{2}[f(\theta_i^*)]^2\Delta \theta_i, \quad \text{où $\theta_i^*\in [\theta_{i-1},\theta_{i}]$}
\end{align*}

La figure \@ref(fig:airepolaire2) représente une partition.

```{r,echo=FALSE,fig.align="center",label="airepolaire2",out.width="50%",fig.cap="Aire d'une courbe polaire: séparation en secteurs"}
knitr::include_graphics("resources/images/latex/airepolaire2.png")
```

Nous voulons trouver l'aire totale, c'est-à-dire la somme des surfaces des $N$ secteurs:
\begin{align*}
A\approx \sum_{i=1}^N\dfrac{1}{2}[f(\theta_i^*)]^2\Delta \theta_i
\end{align*}
Nous remarquons que cette somme est une somme de Riemann. Ainsi, en prenant la limite lorsque $N$ tend vers l'infini, nous obtenons:
\begin{align*}
A=\lim_{N\rightarrow \infty } \sum_{i=1}^N\dfrac{1}{2}[f(\theta_i^*)]^2\Delta \theta_i=\int_{\theta_a}^{\theta_b}\dfrac{1}{2}[f(\theta)]^2d \theta
\end{align*}

D'où, l'aire est donnée par:
\begin{align*}
A &= \int_{\theta_a}^{\theta_b}\dfrac{1}{2}[f(\theta)]^2 d\theta
\end{align*}

```{example}
Calculez l'aire de la région formée par $r=1+\sin(2\theta)$.
```
```{r,echo=FALSE,fig.align="center",label="ex1airepolaire",out.width="50%"}
knitr::include_graphics("resources/images/latex/ex1airepolaire.png")
```
\vspace*{10cm}


```{example}
Calculez l'aire située au-dessus du cercle $r=3\sin(\theta)$ et en dessous de la cardioïde $r=1+\sin(\theta)$.
```
```{r,echo=FALSE,fig.align="center",label="ex2airepolaire",out.width="50%"}
knitr::include_graphics("resources/images/latex/ex2airepolaire.png")
```
\vspace*{10cm}

```{example}
Calculez l'aire d'une seule feuille de $r=1+\sin(\theta)$ avec $0\leq \theta \leq \frac{\pi}{3}$.
```
\vspace*{10cm}

```{example}
Calculez l'aire du quadrifolium $r=\cos(2\theta)$ si un seul pétale se trouve dans l'intervalle $\frac{\pi}{4}\leq \theta \leq \frac{3\pi}{4}$.
```
\vspace*{10cm}

## Longueur d'une courbe

```{theorem,name="Longueur d'une courbe en coordonnées polaires"}
La longueur d'une courbe en coordonnées polaires  définie par $r=f(\theta)$ où $\theta_a\leq\theta\leq\theta_b$ est donnée par:
\begin{align*}
L=\int_{\theta_a}^{\theta_b}\sqrt{\left(\dfrac{dr}{d\theta}\right)^2+r^2}d\theta
\end{align*}

```
```{proof}
La démonstration suivante escamote plusieurs utilisations des sommes de Riemann pour simplifier.

Nous savons que:
\begin{align*}
L &= \int_a^b \sqrt{1+\left(\dfrac{dy}{dx}\right)^2}dx \\
&= \int_a^b \sqrt{(dx)^2\left(1+\left(\dfrac{dy}{dx}\right)^2\right)} \\
&= \int_a^b \sqrt{(dx)^2+(dy)^2} \\
&= \int_a^b \sqrt{\left(\dfrac{dx}{d\theta}d\theta\right)^2+\left(\dfrac{dy}{d\theta}d\theta\right)^2} \\
&= \int_a^b \sqrt{\left(\dfrac{dx}{d\theta}\right)^2+\left(\dfrac{dy}{d\theta}\right)^2}d\theta
\end{align*}
Nous savons par le théorème \@ref(thm:tangente-polaire) ce que sont $\dfrac{dx}{d\theta}$ et $\dfrac{dy}{d\theta}$. Ainsi:
\begin{align*}
L &= \int_a^b \sqrt{\left(\dfrac{dr}{d\theta}\cos(\theta)-r\sin(\theta)\right)^2+\left(\dfrac{dr}{d\theta}\sin(\theta)+r\cos(\theta)\right)^2}d\theta \\
&= \ldots \\
&= \int_{\theta_a}^{\theta_b}\sqrt{\left(\dfrac{dr}{d\theta}\right)^2+r^2}d\theta 
\end{align*}

```

Voici quelques exemple de longueurs d'arc.

```{example}
Calculez la longueur d'arc de $r=e^{2\theta}$ avec $\theta\in[0,2\pi]$.
```
\vspace*{8cm}

```{example}
Calculez la longueur d'arc de $r=2-2\cos(\theta)$ avec $\theta\in[0,2\pi]$.
```
\vspace*{8cm}

```{example}
Calculez la longueur d'arc de $r=ae^{-b\theta}$ avec $\theta\in[0,\infty[$ et $b>0$.
```
\vspace*{10cm}

```{example}
Calculez la longueur d'arc de $r=a(1-\sin(\theta))$ avec $\theta\in[0,2\pi]$.
```
\vspace*{8cm}


## GeoGebra {#geogebra-polaire}

<script type="text/javascript" src="https://cdn.geogebra.org/apps/deployggb.js"></script>
<script type="text/javascript">
var parameters = {
"appName":"graphing",
"material_id":"khn4c2md",
"width":800,
"height":600,
"showToolBar":true,
"borderColor":null,
"showMenuBar":true,
"showFullscreenButton":true,
"enableShiftDragZoom":true};

var applet = new GGBApplet(parameters, 'applet_container');
window.onload = function() { applet.inject('applet_container'); updateHelp('AG');}
</script>
<div id="applet_container"></div>

\newpage
## Pages supplémentaires

Des pages blanches supplémentaires pour ajouter, potentiellement, de nouveaux exemples et exercices.

<!-- Code pour insérer des pages blanches dans le document pdf pour des exemples supplémentaires. -->

\multido{\i=1+1}{4}{
\newpage
\mbox{}
}

<!--chapter:end:03-polaire.Rmd-->

# Les fonctions de plusieurs variables {#fctvar}

```{r,echo=FALSE,message=FALSE,warning=FALSE}
library(pracma)
library(plotly)
library(leaflet)
```

Vous trouverez à la section \@ref(geogebra-fctvar) une application [GeoGebra](https://www.geogebra.org/?lang=fr) vous permettant de visualiser des coupes transversales et des courbes de niveaux. À noter que cette application n'est disponible que dans la version en ligne de ce document.

## Introduction

Jusqu'à présent dans vos cours de calcul différentiel et intégral, nous n'avons étudié que les fonctions d'une seule variable, c'est-à-dire des fonctions de la forme $y=f(x)$. Nous avons appris à dessiner ces fonctions, à les dériver, à les intégrer, etc. Par contre, il est utile d'étudier les fonctions de plus d'une variable car la plupart des phénomènes étudiés dépendent de plus d'un paramètre.

Dans ce chapitre, nous reprendrons les différents thèmes étudiés sur les fonctions d'une seule variable, pour les généraliser sur les fonctions de plusieurs variables.

## Définitions

Débutons en rappelant le concept de fonction et en le généralisant aux fonctions de deux variables ou plus.

```{definition,name="Fonction"}
Soit un ensemble $A$ et un ensemble $B$. Une fonction $f$ est une application qui pour chaque élément
$x\in A$  lui associe un seul élément $y\in B$. On note cette fonction 
\begin{align*}
f:\ A&\longrightarrow  B\\
x&\longrightarrow  y=f(x)
\end{align*} 

  - L'ensemble $A$ se nomme \textbf{domaine} de $f$, noté $\text{dom}(f)$.
  - L'ensemble $B$ est le \textbf{codomaine} de la fonction $f$, noté $\text{codom}(f)$.


```

```{definition,name="Image d'une fonction"}
L'image d'une fonction est l'ensemble de tous les éléments du codomaine qui sont obtenus par la fonction $f$. Nous notons l'image $\text{ima}(f)$. En langage mathématique, l'image s'écrit comme suit:
\begin{align*}
\text{ima}(f):=\{y|y=f(x),\forall x\in dom(f)\}
\end{align*}
Il est à remarquer que $\text{ima}(f)\subseteq \text{codom}(f)$. 
```

La distinction entre l'image et le codomaine est représentée à la figure \@ref(fig:representationfonction). Le codomaine est l'ensemble $B$ tandis que l'image est l'ensemble de tous les éléments de $B$ qui sont reliés à
un ou plusieurs éléments de $A$ par la fonction (ici l'image est la région ombragée).

```{r,echo=FALSE,fig.align="center",label="representationfonction",out.width="50%",fig.cap="Graphique saggital représentant une fonction."}
knitr::include_graphics("resources/images/latex/representationfonction.png")
```

Jusqu'à maintenant, nous avons étudié les fonctions ayant comme domaine un sous-ensemble de la droite des réels. Dans ce cours, nous étudierons des fonctions ayant comme domaine un sous-ensemble $\mathbb{R}^n$, où $n\in\mathbb{N}$. En langage mathématique, ces fonctions s'écrivent:
\begin{align*}
f: D\subseteq \mathbb{R}^n &\longrightarrow \mathbb{R}\\
(x_1,..,x_n)&\longrightarrow z=f(x_1,..,x_n)
\end{align*}
où $x_1$, ..., $x_n$ sont $n$ variables indépendantes.

## Graphique {#graphiques-divers}

Lorsque nous avons une fonction $y=f(x)$, son graphe correspond à une courbe dans le plan cartésien, c'est-à-dire dans $\mathbb{R}^2$. Pour parvenir à dessiner cette courbe, on fait correspondre une valeur de $y$ pour chaque valeur de $x$.

Lorsque nous somme en présence d'une fonction de deux variables $z=f(x,y)$, le graphique de cette fonction est une surface dans l'espace de trois dimensions, $\mathbb{R}^3$.

Par contre, lorsque notre fonction possède plus de deux variables, il devient difficile, voire impossible de la représenter graphiquement. Il faudrait utiliser des espaces de plus de trois dimensions.

```{remark}
Dans le cadre de ce cours, nous nous en tiendrons à des fonctions de une, deux ou trois variables.
```

La figure \@ref(fig:point3d) montre de quelle façon nous pouvons représenter le point (a,b,f(a,b)) dans l'espace à trois dimensions.

```{r point3d,echo=FALSE,fig.align="center",label="point3d",out.width="75%",fig.cap="Représentation en trois dimensions d'un point."}
knitr::include_graphics("resources/images/latex/point3d.png")
## knitr::include_graphics("resources/images/gif/point3d.gif")
```

Nous allons maintenant présenter plusieurs fonctions accompagnées de leur graphique.

```{r graphiques, echo=FALSE}
xy <- meshgrid(linspace(-3,3,20))
x <- xy$X
y <- xy$Y
plan <- 1-x-y
paraboloide <- x^2+y^2
hyperboloide <- x^2-y^2
cone <- sqrt(x^2+y^2)
```

Les figures suivantes représentent des fonctions usuelles que nous rencontrerons régulièrement dans le cours.

```{r ,echo=FALSE,fig.align="center",label="plan",out.width="80%",fig.cap="Plan: $z=1-x-y$"}
if (knitr:::is_html_output()){
  plot_ly(z=plan, showscale=FALSE) %>% add_surface()
} else {
  knitr::include_graphics("resources/images/plan.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="paraboloide",out.width="80%",fig.cap="Paraboloïde: $z=x^2+y^2$"}
if (knitr:::is_html_output()){
  plot_ly(z=paraboloide, showscale=FALSE) %>% add_surface()
} else {
  knitr::include_graphics("resources/images/paraboloide.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="hyperboloide",out.width="80%",fig.cap="Hyperboloïde : $z=x^2-y^2$"}
if (knitr:::is_html_output()){
  plot_ly(z=hyperboloide, showscale=FALSE) %>% add_surface()
} else {
  knitr::include_graphics("resources/images/hyperboloide.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="cone",out.width="80%",fig.cap='Cône : $z=\\sqrt{x^2+y^2}$'}
if (knitr:::is_html_output()){
  plot_ly(z=cone, showscale=FALSE) %>% add_surface()
} else {
  knitr::include_graphics("resources/images/cone.png")
}
```

```{r surfaces,echo=FALSE}
delta <- 0.2
theta <- seq(-pi/2-delta, pi/2+delta, by=delta)
phi <- seq(0, 2*pi+delta, by=delta)
mgrd <- meshgrid(phi, theta)
phi <- mgrd$X
theta <-  mgrd$Y
xs <- cos(theta)*cos(phi)
ys <- cos(theta)*sin(phi)
zs <- sin(theta)

xe <- cos(theta) * cos(phi) * 2
ye <- cos(theta) * sin(phi) * 3
ze <- sin(theta) * 1

a <- 2
c <- 3
u <- seq(-2, 2, by = delta)
v <- seq(0-delta, 2*pi+delta, by = delta)
mgrd <- meshgrid(u,v)
u <- mgrd$X
v <- mgrd$Y
xh1 <- a*sqrt(1+u^2)*cos(v)
yh1 <- a*sqrt(1+u^2)*sin(v)
zh1 <- c*u

a <- 1
c <- 2
u <- seq(-2, 2, by = delta)
v <- seq(0-delta, 2*pi+delta, by = delta)
mgrd <- meshgrid(u,v)
u <- mgrd$X
v <- mgrd$Y
xhh1 <- a*sinh(u)*cos(v)
yhh1 <- a*sinh(u)*sin(v)
zhh1 <- c*cosh(u)
zhh2 <- -zhh1

r <- 1
a <- 2
delta <- 0.2
u <- seq(0-delta, 2*pi+delta, by = delta)
v <- seq(0-delta, 2*pi+delta, by = delta)
mgrd <- meshgrid(u,v)
u <- mgrd$X
v <- mgrd$Y
xt <- (a+r*cos(u))*cos(v)
yt <- (a+r*cos(u))*sin(v)
zt <- r*sin(u)
```


```{r ,echo=FALSE,fig.align="center",label="sphere",out.width="80%",fig.cap='Sphère: $x^2+y^2+z^2=R^2$'}
if (knitr:::is_html_output()){
  plot_ly(x=xs, y=ys, z=zs, type="surface",showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/sphere.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="ellipse",out.width="80%",fig.cap='Ellipse: $\\dfrac{x^2}{a^2}+\\dfrac{y^2}{b^2}+\\dfrac{z^2}{c^2}=1$'}
if (knitr:::is_html_output()){
  plot_ly(x=xe, y=ye, z=ze, type="surface", showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/ellipse.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="hyper1nappe",out.width="80%",fig.cap='Hyperboloïde à une nappe: $\\dfrac{x^2}{a^2}+\\dfrac{y^2}{b^2}-\\dfrac{z^2}{c^2}=1$'}
if (knitr:::is_html_output()){
  plot_ly(x=xh1, y=yh1, z=zh1, type="surface",showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/hyper1nappe.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="hyper2nappe",out.width="80%",fig.cap='Hyperboloïde à deux nappes: $-\\dfrac{x^2}{a^2}-\\dfrac{y^2}{b^2}+\\dfrac{z^2}{c^2}=1$'}
if (knitr:::is_html_output()){
  plot_ly(x=xhh1, y=yhh1,showscale=FALSE) %>% 
    add_surface(z = zhh1) %>% 
    add_surface(z = zhh2)
} else {
  knitr::include_graphics("resources/images/hyper2nappe.png")
}
```

```{r ,echo=FALSE,fig.align="center",label="tore",out.width="80%",fig.cap='Tore: $(x^2+y^2+z^2+a^2-r^2)^2=4 a^2(x^2+y^2)$'}
if (knitr:::is_html_output()){
  plot_ly(x=xt, y=yt, z=zt, type="surface",showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/tore.png")
}
```

## Comment étudier les graphiques de fonctions de deux variables

Comme vous avez pu voir dans les figures précédentes de la section \@ref(graphiques-divers), les surfaces en trois dimensions peuvent être complexes et difficiles à dessiner à la main. Pour tenter  de nous aider à représenter graphiquement ces fonctions, nous allons introduire deux nouveaux outils: les coupes transversales et les courbes de niveaux.

```{remark}
Lorsque vous vous trouvez dans la version en ligne de ce document et que vous placez le curseur de votre souris sur les figures précédentes, vous devriez apercevoir des lignes et des courbes noires, centrées sur votre curseur. Ces lignes et courbes correspondent aux coupes transversales et aux courbes de niveaux.
```

### Les coupes transversales

L'idée des coupes transversales est de fixer la valeur de l'une des deux variables indépendantes. À ce moment, nous observons la fonction dans le plan où est fixé la variable. Si nous fixons $x=k$ où $k\in\mathbb{R}$, nous coupons la surface avec le plan $x=k$. Nous étudions donc une courbe dans le plan $x=k$ et cette courbe se trouve dans un espace à deux dimensions.

Pour bien visualiser les coupes transversales, nous vous invitons à utiliser l'application [GeoGebra](https://www.geogebra.org/?lang=fr) de la section \@ref(geogebra-fctvar).

```{r,echo=FALSE}
mshgrd <- meshgrid(seq(-3,3,by=0.2),seq(-3,3,by=0.2))
xs <- mshgrd$X
ys <- mshgrd$Y
zs <- (xs^2+ys)/10*3

mshplan <-  meshgrid(rep(-1,31))
xp1 <- mshplan$X
yp1 <- mshgrd$X
zp1 <- mshgrd$Y

mshplan <-  meshgrid(rep(1,31))
xp2 <- mshgrd$X
yp2 <- mshplan$X
zp2 <- mshgrd$Y
```

```{example}
Dessinez les coupes transversales de la fonction $z=f(x,y)=x^2+y$.
```

La figure \@ref(fig:fctcoupe) représente la fonction $f(x,y)$.

```{r ,echo=FALSE,fig.align="center",label="fctcoupe",out.width="80%",fig.cap='Graphique de $f(x,y)=x^2+y$'}
if (knitr:::is_html_output()){
  plot_ly(x=xs, y=ys, z=zs, type="surface",showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/fct_coupe.png")
}
```

Déterminons tout d'abord les familles de courbes obtenues lorsque nous fixons la valeur de la variable $x$. Posons $x=k$ où $k$ est une constante. Ainsi $f(k,y)=z=k^2+y$. Donc dans le plan $x=k$, l'allure de la fonction est une droite d'équation $z=y+k^2$, comme on peut le voir à la figure \@ref(fig:fctcoupe1).

```{r ,echo=FALSE,fig.align="center",label="fctcoupe1",out.width="80%",fig.cap='Graphique de $f(x,y)=x^2+y$ et du plan $x=-1$'}
if (knitr:::is_html_output()){
  plot_ly(x=xs,y=ys,z=zs,type="surface",showscale=FALSE) %>% 
    add_surface(x=xp1,y=yp1,z=zp1)
} else {
  knitr::include_graphics("resources/images/fct_coupe_plan1.png")
}
```

Déterminons maintenant les familles de courbes obtenues lorsque nous fixons la valeur de la variable $y$. Posons $y=k$ où $k$ est une constante. Ainsi $f(x,k)=z=x^2+k$. Donc dans le plan $y=k$, l'allure de la fonction est une parabole d'équation $z=x^2+k$, comme on peut le voir à la figure \@ref(fig:fctcoupe2).

```{r ,echo=FALSE,fig.align="center",label="fctcoupe2",out.width="80%",fig.cap='Graphique de $f(x,y)=x^2+y$ et du plan $y=1$'}
if (knitr:::is_html_output()){
  plot_ly(x=xs,y=ys,z=zs,type="surface",showscale=FALSE) %>% 
    add_surface(x=xp2,y=yp2,z=zp2)
} else {
  knitr::include_graphics("resources/images/fct_coupe_plan2.png")
}
```

### Les courbes de niveaux

```{definition,name="Courbes de niveaux"}
Soit une fonction définie par $z=f(x,y)$ et $k\in\mathbb{R}$. La courbe de niveau $k$ correspond à l'ensemble des points $(x,y)$ tels que $f(x,y)=k$.
```

```{remark}
Les courbes de niveaux correspondent donc à une coupe transversale de la fonction lorsque nous fixons la variable dépendante.
```


> La fonction est constante le long de ses courbes de niveaux.

Les applications les plus répandues des courbes de niveaux sont dans les cartes topographiques. Une carte topographique est une carte à échelle réduite représentant le relief déterminé par altimétrie et les aménagements humains d'une région géographique de manière précise et détaillée sur un plan horizontal. La figure \@ref(fig:montgreg) représente une carte topographique du Mont Saint-Grégoire. Dans la version en ligne de ce document, vous pouvez vous déplacer dans la carte et aller voir le relief topographique ailleurs sur la planète.

```{r ,echo=FALSE,fig.align="center",label="montgreg",out.width="80%",fig.cap='Carte topographique du Mont Saint-Grégoire'}
leaflet() %>%
  addTiles(urlTemplate="//{s}.tile.opentopomap.org/{z}/{x}/{y}.png") %>% 
  addMarkers(lat = 45.357059, lng = -73.147859, popup = "Mont Saint-Grégoire")
```

Un autre exemple de carte topographique peut être obtenu en utilisant des données topographiques du volcan __Maunga Whau__ situé dans la région d'Auckland. Les données sont distribuées sur une grille de 10 mètres par 10 mètres. La figure \@ref(fig:volcano3d) représente le volcan en trois dimensions.

```{r, echo=FALSE,fig.align="center",label="volcano3d",out.width="80%",fig.cap='Représentation du volcan Maunga Whau'}
if (knitr:::is_html_output()){
  plot_ly(z=~volcano,type="surface",showscale=FALSE)
} else {
  knitr::include_graphics("resources/images/volcano.png")
}
```

Nous pouvons représenter les courbes de niveaux de ce volcan comme à la figure \@ref(fig:volcano2d).

```{r, echo=FALSE,fig.align="center",label="volcano2d",out.width="80%",fig.cap='Courbes de niveaux du volcan Maunga Whau'}
if (knitr:::is_html_output()){
  plot_ly(z=~volcano,type="contour")
} else {
  knitr::include_graphics("resources/images/volcano-contour.png")
}
```

Faisons maintenant quelques exemples.

```{example}
Déterminez la nature des courbes de niveaux du paraboloïde $f(x,y)=x^2+y^2$. Dessinez quelques courbes de niveaux.
```
\vspace*{6cm}

```{example}
Trouvez les courbes de niveaux de la fonction $f(x,y)=x^2-y$.
```
\vspace*{6cm}

```{example}
Trouvez les courbes de niveaux de la fonction $f(x,y)=ye^{-|x|}$.
```
\vspace*{6cm}

```{example}
Trouvez les courbes de niveaux de la fonction $f(x,y)=e^{x^2-y^2}$.
```
\vspace*{6cm}

```{example}
Trouvez les courbes de niveaux de la fonction $f(x,y)=\ln(4-x^2-4y^2)$.
```
\vspace*{6cm}


## Domaine

```{definition,name="Domaine d'une fonction"}
Le domaine d'une fonction réelle $f(x_1,\ldots,x_n)$ (ou domaine de définition d'une fonction),  noté $\text{dom} f$,  est un sous ensemble de $\mathbb{R^n}$ qui contient toutes les valeurs de $x_i$ avec $i=1,\ldots, n$, pour lesquelles la règle de correspondance de $f(x_1,\ldots,x_n)$ est définie. 
```

Pour déterminer le domaine d'une fonction réelle $f(x_1,\ldots,x_n)$,  il suffit de suivre les étapes suivantes:

  1. Vérifier si $f(x_1,\ldots,x_n)$ est définie dans un contexte, afin de voir si celui-ci restreint les valeurs des variables indépendantes.
  1. Enlever les valeurs des variables indépendantes qui annulent le dénominateur.
  1. L'argument des racines paires doit être plus grand ou égal à zéro, c'est-à-dire $\geq 0$.
  1. L'argument des logarithmes doit être __strictement__ plus grand que zéro, c'est-à-dire $> 0$.
  1. Les fonctions trigonométriques usuelles ont souvent des dénominateurs, par exemple $\tan$, $\cot$, $\csc$ et $\sec$. De plus, les fonctions trigonométriques inverses ont souvent des domaines restreints.
  
Voici quelques exemples.

```{example}
Déterminez le domaine des fonctions suivantes:
  
  a. $f(x,y)=x^2+y^2$
  a. $f(x,y)=\dfrac{1}{9-x^2-y^2}$
  a. $f(x,y)=\dfrac{\sqrt{9-x^2-y^2}}{x-y}$
  a. $f(x,y)=\ln(4-x^2-4y^2)$
  a. $f(x,y)=\sqrt{x^2+y^2-1}+\sqrt{4-x^2-y^2}$
  a. $f(x,y)=\sqrt{x(1-|y|)}$
  a. $f(x,y)=\dfrac{xy}{x^2-y^2}$
  a. $f(x,y)=\dfrac{1}{\sqrt{x^2-y^2}}$
  
  
```
\vspace*{20cm}

## Limites

Nous allons débuter en rappelant la définition de la limite d'une fonction à une variable.

```{definition, name="Limite d'une fonction à une variable"}
Soit une fonction $f(x)$. Nous disons que $L$ est la limite de $f(x)$ lorsque $x$ tend vers $a$ si pour tout $\epsilon >0$, il existe $\delta$ tel que si $|x-a|<\delta$ alors $|f(x)-L|<\epsilon$. Nous notons alors:
$$ \lim_{x\to a} f(x) = L $$


```

__WIP__

```{proposition, name="Les propriétés des limites"}
Soit $f(x,y)$ et $g(x,y)$ deux fonctions de deux variables.

\begin{align*}
& \lim_{(x,y)\to(a,b)}f(x,y)\pm g(x,y)=\lim_{(x,y)\to(a,b)}f(x,y)\pm \lim_{(x,y)\to(a,b)} g(x,y) \\
& \lim_{(x,y)\to(a,b)}f(x,y)\cdot  g(x,y)=\lim_{(x,y)\to(a,b)}f(x,y)\cdot \lim_{(x,y)\to(a,b)} g(x,y) \\
& \lim_{(x,y)\to(a,b)}\dfrac{f(x,y)}{g(x,y)}=\dfrac{\lim\limits_{(x,y)\to(a,b)}f(x,y)}{ \lim\limits_{(x,y)\to(a,b)} g(x,y)}\quad \text{si $g(x,y)\neq 0$ près de $(a,b)$}
\end{align*}


```

```{example}
Trouvez la limite suivante:

$$
\lim_{(x,y)\to(1,2)} (x^2+y)
$$

```

```{example, label="lim-sin-sur-x"}
Trouvez la limite suivante:

$$
\lim_{(x,y)\to(0,0)}\dfrac{\sin (x^2+y^2)}{x^2+y^2}
$$

```

Nous avons pu lever l'indétermination de l'exemple \@ref(exm:lim-sin-sur-x) en utilisant une limite vue dans un cours de calcul intégral. Malheureusement, il sera habituellement plus difficile de lever des indéterminations. En particulier, il n'existe pas d'analogue à la règle de L'Hospital pour des fonctions de deux variables ou plus. 

Nous verrons par contre deux techniques pour être en mesure de calculer des limites de fonctions de deux variables ou plus: la méthode des chemins et la méthode du gendarme.

### La méthode des chemins

Cette méthode est une généralisation du principe de la limite à droite et de la limite à gauche. Lorsque nous avons:

$$ \lim_{x\to a} f(x) $$

cela signifie que la valeur de $x$ s'approche de $a$. La variable $x$ peut s'approcher de $a$ de deux façons différentes, par la droite ou par la gauche. Dans le cas de la limite suivante:

$$ \lim_{(x,y)\to (a,b)} f(x,y) $$

cela signifie que nous devons nous approcher du point $(a,b)$. Par contre, il existe plus de deux façons de se rendre au point $(a,b)$. Il en existe en fait une infinité! La figure \@ref(fig:limites2d-3d) présente une représentation d'une limite pour une fonction d'une seule variable dans la figure de gauche. Dans la figure de droite, nous montrons trois chemins possibles, parmi l'infinité de chemins possibles.

```{r, echo=FALSE,fig.align="center",label="limites2d-3d",out.width="45%",fig.cap="Représentation d'une limite en deux dimensions et d'une autre en trois dimensions.",fig.show='hold'}
knitr::include_graphics(c("resources/images/latex/limite2d.png", "resources/images/latex/limite3d.png"))
```

```{example}
Déterminez, si elle existe, la limite suivante:
  
$$ \lim_{(x,y)\to (0,0)}\dfrac{x^2}{x^2+y^2} $$

```

En général, nous désirons trouver la limite en $(0,0)$ et nous allons tester les chemins suivants:

- $x=0$
- $y=0$
- $y=x$
- $y=kx$ où $k$ est une constante
- $y=kx^2$ où $k$ est une constante

```{remark}
La méthode des chemins ne permet que de démontrer qu'une limite __n'existe pas__.
```


```{example}
Déterminez, si elle existe, la limite suivante:
  
$$ \lim_{(x,y)\to (0,0)}\dfrac{xy}{x^2+y^2} $$

```

```{example}
Déterminez, si elle existe, la limite suivante:
  
$$ \lim_{(x,y)\to (0,0)}\dfrac{xy^2}{x^2+y^4} $$

```

```{example}
Déterminez, si elle existe, la limite suivante:
  
$$ \lim_{(x,y)\to (0,0)}\dfrac{x^2+y^2}{y} $$

```

### La méthode des gendarmes

Puisque la méthode des chemins ne nous permet pas de démontrer qu'une limite existe, nous allons introduire la méthode des gendarmes, qui elle permet de démontrer qu'une limite existe. Nous débutons pas utiliser la méthode des chemins pour calculer la limite:

$$ \lim_{(x,y)\to (a,b)}f(x,y) $$

Si tous les chemins nous donnent une limite égale à $L$, nous pouvons présumer que:

$$ \lim_{(x,y)\to (a,b)}f(x,y)=L $$

Nous voulons maintenant trouver une fonction $M(x,y)$ telle que:

$$ 0 \leq |f(x,y)-L| \leq M(x,y) $$

et telle que la limite suivante est vérifiée:

$$ \lim_{(x,y)\to (a,b)} M(x,y) = 0 $$

Nous nous retrouvons donc dans la situation suivante:

\begin{align*}
0 &\leq |f(x,y)-L| &\leq M(x,y) \\
\lim_{(x,y)\to (a,b)} 0 &\leq \lim_{(x,y)\to (a,b)}|f(x,y)-L| &\leq \lim_{(x,y)\to (a,b)}M(x,y) \\
0 &\leq \lim_{(x,y)\to (a,b)}|f(x,y)-L| &\leq 0
\end{align*}

Nous pouvons donc conclure que:

$$ \lim_{(x,y)\to (a,b)}f(x,y)=L $$

Pour utiliser la méthode des gendarmes, nous utiliserons à plusieurs reprises l'inégalité suivante.

```{proposition}
Soit $x$ et $y$ deux nombres réels. Nous avons:
\begin{align*}
\left|\dfrac{x^2}{x^2+y^2}\right| &\leq 1 \\
\left|\dfrac{y^2}{x^2+y^2}\right| &\leq 1
\end{align*}


```
```{proof}
Nous avons:
\begin{align*}
x^2 &\leq x^2+y^2 \\
\dfrac{x^2}{x^2+y^2} &\leq 1
\end{align*}
L'autre inégalité se démontre de la même manière.
```


```{example}
Trouvez la limite suivante:
$$ \lim_{(x,y)\to (0,0)}\dfrac{x^2y}{x^2+y^2} $$
  
  
```

```{example}
Trouvez la limite suivante:
$$ \lim_{(x,y)\to (0,0)}\dfrac{y^3}{x^2+y^2} $$
  
  
```


### Exercises divers de limites

```{example}
Trouvez, si possible, les limites suivantes:

a. $\lim_{(x,y)\to (2,-1)} (xy+y^2)$
a. $\lim_{(x,y)\to (0,0)} \sqrt{x^2+y^2}$
a. $\lim_{(x,y)\to (0,0)} \dfrac{x}{x^2+y^2}$
a. $\lim_{(x,y)\to (0,0)} \dfrac{\cos(xy)}{1-x-\cos(y)}$
a. $\lim_{(x,y)\to (0,1)} \dfrac{x^2(y-1)^2}{x^2+(y-1)^2}$
a. $\lim_{(x,y)\to (0,0)} \dfrac{\sin(x-y)}{\cos(x+y)}$
a. $\lim_{(x,y)\to (0,0)} \dfrac{\sin(xy)}{x^2+y^2}$


```

## La continuité

La notion de continuité pour les fonctions de plusieurs variables est similaire à celle des fonctions d'une seule variable.

```{definition, name="Continuité pour les fonctions de deux variables"}
Soit une fonction $f(x,y)$ et un point $(a,b)\in\text{dom} f$. Nous disons que $f(x,y)$ est continue au point $(a,b)$ si:
$$ \lim_{(x,y)\to (a,b)} f(x,y) = f(a,b) $$


```

> Cette définition se généralise facilement aux fonctions de trois variables ou plus.

```{example}
Déterminez si la fonction suivante:
  
$$ 
f(x,y) = \begin{cases}
\dfrac{x^2y}{x^2+y^2} & \text{si } (x,y)\neq (0,0) \\
0 & \text{si } (x,y)= (0,0)
\end{cases}
$$
est continue en $(0,0)$.
```

```{example}
Comment la fonction $f(x,y)=\dfrac{x^2+y^2-x^3y^3}{x^2+y^2}$ définie pour tous les $(x,y)\neq (0,0)$ peut-elle être définie à l'origine pour qu'elle soit continue partout sur $\mathbb{R}^2$?
```

```{example}
Comment la fonction $f(x,y)=\dfrac{x^3-y^3}{x-y}$ définie pour tous les $x\neq y$ peut-elle être définie à l'origine pour qu'elle soit continue partout sur $\mathbb{R}^2$?
```

```{example}
Déterminez si la fonction suivante:
  
$$ 
f(x,y) = \begin{cases}
\sin\left(\dfrac{x}{y}\right) & \text{si } x\neq 0 \text{ et } y\neq 0 \\
1 & \text{si } x= 0 \text{ et } y= 0
\end{cases}
$$
est continue en $(0,0)$.
```

## Geogebra {#geogebra-fctvar}

<script type="text/javascript" src="https://cdn.geogebra.org/apps/deployggb.js"></script>
<script type="text/javascript">
var parameters = {
"appName":"graphing",
"material_id":"ms6jdhhg",
"width":800,
"height":600,
"showToolBar":true,
"borderColor":null,
"showMenuBar":true,
"showFullscreenButton":true,
"enableShiftDragZoom":true};

var applet = new GGBApplet(parameters, 'applet_container');
window.onload = function() { applet.inject('applet_container'); updateHelp('AG');}
</script>
<div id="applet_container"></div>

\newpage
## Pages supplémentaires

Des pages blanches supplémentaires pour ajouter, potentiellement, de nouveaux exemples et exercices.

<!-- Code pour insérer des pages blanches dans le document pdf pour des exemples supplémentaires. -->

\multido{\i=1+1}{4}{
\newpage
\mbox{}
}

<!--chapter:end:04-fctvars.Rmd-->

# La dérivation de fonctions de plusieurs variables {#derivfctvars}

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# install.packages('DiagrammeR')
library(DiagrammeR)
```

Un test

## Introduction

Nous sommes maintenant prêts à aborder la notion de dérivée pour les fonctions de deux variables ou plus. 

## Les dérivées partielles

Nous allons débuter en rappelant la définition de la dérivée d'une fonction d'une seule variable.

```{definition, name="Dérivée d'une fonction d'une seule variable"}
Soit $f(x)$ une fonction. La dérivée de la fonction $f(x)$, notée $f'(x)$ ou $\dfrac{df}{dx}$ est donnée par:
$$ \lim_{\Delta x \to 0} \dfrac{f(x+\Delta x)-f(x)}{\Delta x} $$
```

Nous savons que la dérivée d'une fonction correspond, entre autres, à la pente de la droite tangente. Dans le cas d'une fonction de plus d'une variable, la notion de pente de droite tangente en un point n'existe pas à priori. Nous devrons donc définir une nouvelle définition de dérivée.

Nous allons débuter par introduire la notion de dérivée pour les fonctions de deux variables. La généralisation pour les fonctions de plus de deux variables se fait facilement.

Soit une fonction $z=f(x,y)$. Pour étudier les deux (une par variable indépendante) dérivées partielles de cette fonction, nous allons les  variations de cette fonction.

Supposons que nous nous trouvons dans un plan où la variable $y$ est constante. Ceci signifie que seule la variable $x$ varie, c'est-à-dire que nous partons du point $(x,y)$ jusqu'au point $(x+\Delta x,y)$. Puisque nous avons deux points, nous pouvons déterminer le taux de variation de la fonction $f(x,y)$ par rapport à la vraible $x$. Ce taux est donné par:

$$  \dfrac{f(x+\Delta x,y)-f(x,y)}{\Delta x} $$

Lorsque nous prenons la limite de ce taux de variation lorsque $\Delta x$ tend vers $0$, nous obtenons la dérivée partielle de $f(x,y)$ par rapport à $x$. Mathématiquement, nous écrivons:

$$ \dfrac{\partial f}{\partial x}=\lim_{\Delta x \to 0} \dfrac{f(x+\Delta x,y)-f(x,y)}{\Delta x} $$

D'une manière similaire, nous pouvons définir la dérivée partielle de $f(x,y)$ par rapport à $y$:

$$ \dfrac{\partial f}{\partial y}=\lim_{\Delta y \to 0} \dfrac{f(x,y+\Delta y)-f(x,y)}{\Delta y} $$

Géométriquement, la dérivée partielle de $f(x,y)$ par rapport à $x$ correspond à la pente de la droite tangente à la courbe engendrée par l'intersection du plan $y=k$ où $k$ est une constante et la surface $z=f(x,y)$.

La figure \@ref(fig:derivee-partielle-x) représente dans l'image de gauche la surface $z=f(x,y)$ coupée par le plan $y=k$ où $k$ est une constante. Nous apercevons l'intersection de la surface et du plan, représentée par une courbe parabolique. La ligne pointillée représente la droite tangente à la surface dans le plan $y=k$. La figure de droite représente la fonction parabolique dans le plan $y=k$ ainsi que la droite tangente.

```{r,echo=FALSE,fig.show="hold",fig.align="center",label="derivee-partielle-x",out.width="50%",fig.cap="Représentation géométrique de la dérivée partielle de $f(x,y)$ par rapport à $x$"}
knitr::include_graphics(c("resources/images/geogebra/deriveepartiellex3d.png","resources/images/geogebra/deriveepartiellex2d.png"))
```

C'est la même correspondance pour $\dfrac{\partial f}{\partial y}$, il suffit d'étudier la courbe dans le plan $x=k$ où $k$ est une constante. 

> Lorsque nous trouvons la dérivée partielle d'une fonction $f(x_1,x_2,\ldots,x_n)$ par rapport à la variable indépendante $x_i$, nous supposons toutes les autres variables indépendantes $x_j$ où $j\neq i$ sont des constantes.

```{proposition, name="Notation pour dérivées partielles"}
Soit une fonction $f(x_1,x_2,\ldots,x_n)$. La dérivée partielle de $f$ par rapport à la variable $x_i$ peut être notée par:
  
- $f_{x_i}$
- $f_i$
- $\dfrac{\partial f}{\partial x_i}$
- $D_i f$

Dans le cas où la fonction ne possède que deux variable, c'est-à-dire une fonction $f(x,y)$, nous pouvons noter la dérivée partielle de $f$ par rapport à $x$ par:

- $f_{x}$
- $\dfrac{\partial f}{\partial x}$
- $D_x f$

```


```{example}
Trouvez les dérivées partielles de $f(x,y)=x\cos(x+y^2)$.
```
\vspace*{8cm}

```{example}
Trouvez les dérivées partielles de $f(x,y)=x^2\sin(y)$.
```
\vspace*{8cm}

```{example}
Trouvez les dérivées partielles de $f(x,y)=x^3y^2+x^4y+y^4$.
```
\vspace*{8cm}

```{example}
Trouvez les dérivées partielles de $f(x,y)=e^{xy}\cos(x+y)$.
```
\vspace*{8cm}

```{example}
Soit une fonction $f$ différentiable et d'une seule variable. Montrez que $f\left(\frac{x}{y}\right)$ satisfait l'équation:
$$ x\dfrac{\partial f}{\partial x}+y\dfrac{\partial f}{\partial y} = 0 $$

```
\vspace*{8cm}

### Les dérivées d'ordres supérieurs

Nous allons maintenant définir les dérivées d'ordres supérieurs. Voici les dérivées partielles secondes d'une fonction $f(x,y)$.

```{definition, name="Les dérivées partielles du second ordre"}
Nous avons:
\begin{align*}
\dfrac{\partial^2 f}{\partial x^2} &= 
  \dfrac{\partial}{\partial x}\left[\dfrac{\partial f}{\partial x}\right] =
  f_{xx}(x,y) =
  f_{11}(x,y) \\
\dfrac{\partial^2 f}{\partial y^2} &= 
  \dfrac{\partial}{\partial y}\left[\dfrac{\partial f}{\partial y}\right] =
  f_{yy}(x,y) =
  f_{22}(x,y) \\
\dfrac{\partial^2 f}{\partial x \partial y} &= 
  \dfrac{\partial}{\partial x}\left[\dfrac{\partial f}{\partial y}\right] =
  f_{yx}(x,y) =
  f_{21}(x,y) \\
\dfrac{\partial^2 f}{\partial y \partial x} &= 
  \dfrac{\partial}{\partial y}\left[\dfrac{\partial f}{\partial x}\right] =
  f_{xy}(x,y) =
  f_{12}(x,y)
\end{align*}

```

```{example}
Trouvez toutes les dérivées d'ordre 1 et 2 de la fonction $f(x,y)=x^2y+3y^2$.
```
\vspace*{8cm}


```{example}
Trouvez toutes les dérivées d'ordre 1 et 2 de la fonction $f(x,y)=x^3y^4$.
```
\vspace*{8cm}

```{remark}
Remarquez que dans les deux exemples précédents, les dérivées partielles mixtes sont égales, c'est-à-dire que $f_{xy}=f_{yx}$.
```

```{theorem, name="Le théorème de Clairaut"}
Soit une fonction $f(x,y)$ définie sur un disque $D$ qui contient le point $(a,b)$. Si $f_{xy}$ et $f_{yx}$ sont continues sur $D$, alors:
\begin{align*}
f_{xy}(a,b)=f_{yx}(a,b)
\end{align*}

```
```{proof}
La démonstration est laissée à l'étudiante ou l'étudiant.
```

## Applications des dérivées partielles

Voici quelques applications des dérivées parttielles.

```{example, name="L'équation de Laplace"}
L'équation de Laplace apparaît dans de nombreuses applications de physique théorique. Pour en savoir plus, [Wikipédia: Équation de Laplace](https://fr.wikipedia.org/wiki/%C3%89quation_de_Laplace).

Montrez que les fonctions $f(x,y)=e^{kx}\cos(ky)$ et $g(x,y)=e^{kx}\sin(ky)$ où $k$ est une constante, sont des solutions de l'équation de Laplace donnée par:
  
$$ \dfrac{\partial^2 z}{\partial x^2}+\dfrac{\partial^2 z}{\partial y^2}=0 $$
  
```

```{example, name="L'équation d'onde"}
L'équation d'onde est une équation qui décrit la propagation d'une onde. Pour en savoir plus, [Wikipédia: Équation d'onde](https://fr.wikipedia.org/wiki/%C3%89quation_d%27onde).

Soit $f(u)$ et $g(u)$ deux fonctions dérivables deux fois. Montrez que $\omega=f(x-ct)+g(x+ct)$ où $c$ est une constante, est une solution de l'équation d'onde donnée par:
  
$$ \dfrac{\partial^2 \omega}{\partial t^2} = c^2\dfrac{\partial^2 \omega}{\partial x^2} $$
  
```

```{example, name="L'équation de la chaleur"}
L'équation de la chaleur est une équation aux dérivées partielles pour décrire le phénomène physique de conduction thermique. Pour en savoir plus, [Wikipédia: Équation de la chaleur](https://fr.wikipedia.org/wiki/%C3%89quation_de_la_chaleur).

Montrez que la fonction $u(x,t)=t^{-\tfrac{1}{2}}e^{-\tfrac{x^2}{4t}}$ est une solution de l'équation de la chaleur donnée par:

$$ \dfrac{\partial u}{\partial t} = \dfrac{\partial^2 u}{\partial x^2} $$
  
```


## Le plan tangent

Nous désirons trouver l'équation du plan tangent à une surface donnée par la fonction $z=f(x,y)$ au point $(x_0,y_0,z_0)$ où $z_0=f(x_0,y_0)$. Pour ce faire, nous allons débuter en rappelant comment trouver l'équation cartésienne d'un plan.

### L'équation cartésienne d'un plan

```{definition, name="Le vecteur normal à un plan"}
Soit un plan $\pi$. Un vecteur normal au plan, noté $\vec n$, est un vecteur tel que tous les vecteurs se trouvant sur le plan sont perpendiculaires à $\vec n$.
```

Nous allons maintenant utiliser le vecteur normal au plan pour définir l'équation normale du plan de l'espace. Soit un plan $\pi$ et un vecteur $\vec n=[a,b,c]$ normal à ce plan. Soit aussi un point $P(x_0,y_0,z_0)$ connu faisant partie du plan et un point $Q(x,y,z)$ un point quelconque du plan. La figure \@ref(fig:eq-cartesienne-plan) représente un plan ainsi que l'un de se vecteur normal avec un point $P$ connu.

```{r,echo=FALSE,fig.align="center",label="eq-cartesienne-plan",out.width="75%",fig.cap="Représentation d'un plan avec un de ses vecteur normal."}
knitr::include_graphics("resources/images/latex/eqcartesienneplan.png")
```

Puisque le vecteur normal $\vec n$ est perpendiculaire à tous les vecteurs se trouvant sur le plan, il est en particulier perpendiculaire au vecteur $\overrightarrow{PQ}$. Si nous définissons le vecteur $\vec p = \overrightarrow{OP}$ et le vecteur $\vec x=\overrightarrow{OQ}$, nous avons que:
\begin{align*}
\vec n \cdot (\vec x - \vec p) &= 0 \quad \text{car $\vec n \perp (\vec x - \vec p)$}
\end{align*}
Nous avons donc:

```{definition, name="L'équation cartésienne d'un plan"}
Soit un plan $\pi$. Soit un vecteur normal à ce plan $\vec n=[a,b,c]$ et un point de ce plan $P(x_0,y_0,z_0)$ connu. L'équation normale du plan est donnée par:
\begin{align*}
\vec n \cdot (\vec x - \vec p) &= 0 \\
[a,b,c] \cdot [x-x_0,y-y_0,z-z_0] &= 0 \\
a(x-x_0)+b(y-y_0)+c(z-z_0) &= 0
\end{align*}
```

Nous sommes maintenant prêts à trouver l'équation du plan tangent à une surface. Pour simplifier la démonstration, nous allons modifier l'équation cartésienne d'un plan.

\begin{align*}
a(x-x_0)+b(y-y_0)+c(z-z_0) &= 0 \\
c(z-z_0)  &= -a(x-x_0)-b(y-y_0) \\
z-z_0 &= \frac{-a}{c}(x-x_0)+\frac{-b}{c}(y-y_0) \\
&= A(x-x_0)+B(y-y_0)
\end{align*}
en posant $A=-\frac{a}{c}$ et $B=-\frac{b}{c}$. 

Pour trouver les constantes $A$ et $B$, nous allons nous placer dans les plans $y=y_0$ et $x=x_0$. Tout d'abord, plaçons-nous dans le plan $y=y_0$. Nous avons donc:

\begin{align*}
z-z_0 &= A(x-x_0)+B(y_0-y_0) \\
z-z_0 &= A(x-x_0) \\
z &= Ax +(z_0-Ax_0)
\end{align*}

L'équation précédente correspond à celle de la droite tangente à la courbe définie par $z=f(x,y_0)$. La pente de cette droite correspond à la dérivée partielle de la fonction $f$ par rapport à $x$, évaluée en $(x_0,y_0)$, c'est-à-dire $A=\left.\dfrac{\partial f}{\partial x}\right|_{(x_0,y_0)}$.

D'une manière similaire, nous montrons que $B=\left.\dfrac{\partial f}{\partial y}\right|_{(x_0,y_0)}$.

L'équation du plan tangent est don donnée par:

$$ z = z_0 + \left.\dfrac{\partial f}{\partial x}\right|_{(x_0,y_0)}\cdot (x-x_0)+\left.\dfrac{\partial f}{\partial y}\right|_{(x_0,y_0)}\cdot (y-y_0) $$

```{example}
Trouvez l'équation du plan tangent à la surface $f(x,y)=9-x^2-y^2$ au point $(1,1)$.
```
\vspace*{8cm}

```{example}
Trouvez l'équation du plan tangent à la surface $f(x,y)=\sin(xy)$ au point $\left(\frac{\pi}{3},-1 \right)$.
```
\vspace*{8cm}

```{example}
Trouvez le plan tangent horizontal à la surface $f(x,y)=x^2-4xy-2y^2+12x-12y-1$
```
\vspace*{8cm}

```{example}
Trouvez l'équation du plan tangent à la surface $f(x,y)=\dfrac{x-y}{x+y}$ au point $(1,1)$.
```
\vspace*{8cm}

```{remark}
Le plan tangent est l'analogue du polynôme de Taylor de degré 1 pour les fonctions de deux variables.
```

## Les fonctions différentiables

### Les différentielles

### Le calcul d'incertitude

```{definition, name="L'erreur absolue et l'erreur relative"}
Soit $a$ une donnée que nous mesurons. Nous notons $\Delta a$ l'erreur absolue de la mesure $a$, c'est-à-dire l'incertitude associée à la prise de mesure de $a$. Nous notons $\dfrac{\Delta a}{a}$ l'erreur relative de $a$.
```

Nous allons maintenant retrouver certaines règles de calcul d'incertitude à l'aide de la différentielle totale d'une fonction.

Soit une fonction $f(x_1,x_2,\ldots,x_n)$ une donnée dépendant de $n$ mesures notées $x_1$, $x_2$, ..., $x_n$. D'après les notions de différentielle, nous avons:

$$ df = \dfrac{\partial f}{\partial x_1} dx_1 + \ldots + \dfrac{\partial f}{\partial x_n} dx_n $$
Nous sommes maintenant en mesure de calculer une valeur maximale pour $df$:

$$ |df| \leq \left|\dfrac{\partial f}{\partial x_1}\right| |dx_1| + \ldots + \left|\dfrac{\partial f}{\partial x_n}\right| |dx_n| $$

En notant les incertitudes $\Delta x = |dx|$ pour toutes les mesures, nous obtenons la relation suivante en prenant la valeur maximale de l'incertitude :

$$ \Delta f = \left|\dfrac{\partial f}{\partial x_1}\right| \Delta x_1 + \ldots + \left|\dfrac{\partial f}{\partial x_n}\right| \Delta x_n $$

#### L'addition ou la soustraction de deux mesures.

Soit $f(x_1,x_2)=x_1\pm x_2$. Nous avons:
\begin{align*}
\Delta f &= \left| \dfrac{\partial f}{\partial x_1} \right| \Delta x_1
+ \left| \dfrac{\partial f}{\partial x_2} \right| \Delta x_2 \\
&= \Delta x_1 \pm \Delta x_2
\end{align*}
Ceci implique que lors de l'addition ou de la soustraction de deux mesures, les erreurs absolues sont additionnées.

#### Le produit d'une mesure par une constante

Soit $f(x_1)=kx_1$ où $k$ est une constante. Nous avons:
\begin{align*}
\Delta f &= \left| \dfrac{\partial f}{\partial x_1} \right| \Delta x_1 \\
&= |k| \Delta x_1
\end{align*}
Ceci implique que lors du produit d'une mesure par une constante, l'erreur absolue de la mesure est multipliée par la valeur absolue de la constante.

#### Le produit de deux mesures

Soit $f(x_1,x_2)=x_1 \cdot x_2$. Nous avons:
\begin{align*}
\Delta f &= \left| \dfrac{\partial f}{\partial x_1} \right| \Delta x_1
+ \left| \dfrac{\partial f}{\partial x_2} \right| \Delta x_2 \\
&= |x_2| \Delta x_1 + |x_1| \Delta x_2 \\
\dfrac{\Delta f}{f} &= \dfrac{|x_2|}{x_1\cdot x_2}\Delta x_1 + \dfrac{|x_1|}{x_1\cdot x_2}\Delta x_2 \\
&= \dfrac{\Delta x_1}{x_1} + \dfrac{\Delta x_2}{x_2}
\end{align*}
Ceci implique que lors du produit de deux mesures, les erreurs relatives sont additionnées.

#### Le quotient de deux mesures

Soit $f(x_1,x_2)=\dfrac{x_1}{x_2}$. Nous avons:
\begin{align*}
\Delta f &= \left| \dfrac{\partial f}{\partial x_1} \right| \Delta x_1
+ \left| \dfrac{\partial f}{\partial x_2} \right| \Delta x_2 \\
&= \left| \dfrac{1}{x_2} \right| \Delta x_1 + \left| \dfrac{-x_1}{x_2^2} \right| \Delta x_2 \\
\dfrac{\Delta f}{f} &= \left| \dfrac{1}{x_2}\dfrac{x_2}{x_1} \right| \Delta x_1 + \left| \dfrac{-x_1}{x_2^2}\dfrac{x_2}{x_1} \right| \Delta x_2 \\
&= \dfrac{\Delta x_1}{x_1} + \dfrac{\Delta x_2}{x_2}
\end{align*}
Ceci implique que lors du quotient de deux mesures, les erreurs relatives sont additionnées.

#### La puissance d'une mesure

Soit $f(x_1)=x_1^n$ où $n\in\mathbb{R}$. Nous avons:
\begin{align*}
\Delta f &= \left| \dfrac{\partial f}{\partial x_1} \right| \Delta x_1 \\
&= |nx_1^{n-1}| \Delta x_1 \\
\dfrac{\Delta f}{f} &= \left| \dfrac{nx_1^{n-1}}{x_1^n} \right| \Delta x_1 \\
&= |n| \dfrac{\Delta x_1}{x_1}
\end{align*}
Ceci implique que lors du calcul de la puissance d'une mesure, nous multiplions l'erreur relative par la valeur absolue de la puissance $n$.

```{example}
Pour mesurer le volume d'un cylindre, nous mesurons sa hauteur et son rayon. Nous obtenons $h=15\ \text{cm}\pm 0,1\ \text{cm}$ et $h=5\ \text{cm}\pm 0,1\ \text{cm}$. Trouvez l'erreur absolue et l'erreur relative sur le volume du cylindre.
```
\vspace*{8cm}

```{example}
La période d'oscillation $T$ d'un pendule simple dépend de la longueur du pendule $l$, $T=2\pi\sqrt{\dfrac{l}{g}}$. En mesurant la période du pendule et sa longueur (deux mesures), nous pouvons obtenir la valeur de la constante gravitationnelle $g=\dfrac{4\pi^2 l}{T^2}$. Trouvez l'erreur absolue et l'erreur relative sur la mesure de $g$, en fonction des incertitudes sur $T$ et $l$.
```
\vspace*{8cm}

## La règle de dérivation en chaîne et la dérivation implicite

Nous savons que si $y=f(x)$ et $x=x(t)$, alors la dérivée de la composition des fonctions $f\circ x$ est:

$$ \dfrac{dy}{dt} = \dfrac{df}{dx}\dfrac{dx}{dt} $$

C'est ce que nous nommons la __règle de dérivation en chaîne__. Nous voulons maintenant introduire une règle similaire pour les fonctions de plusieurs variables. Débutons par étudier la règle pour les fonctions de deux variables. La généralisation pour les fonctions de trois variables ou plus se fait de façon similaire.

```{theorem, name="La règle de dérivation en chaîne pour les fonctions de deux variables", label="deriv-chaine-1"}
Soit une fonction différentiable $z=f(x,y)$ et soit $x=x(t)$ et $y=y(t)$. Nous avons alors:
  
$$ \dfrac{dz}{dt} = \dfrac{\partial f}{\partial x}\dfrac{dx}{dt}+
  \dfrac{\partial f}{\partial y}\dfrac{dy}{dt} $$
  

```

```{remark}
La dérivée $\dfrac{dz}{dt}$ est une dérivée habituelle et non partielle. En effet, la fonction $z=f(x,y)$ ne dépend que d'une seule variable, $t$. Lorsqu'une fonction dépend d'une seule variable, nous utilisons $d$ et lorsqu'elle dépend de deux variables ou plus, nous utilisons $\partial$.
```

La manière la plus simple de trouver une dérivée à l'aide du théorème \@ref(thm:deriv-chaine-1), est de construire un schéma de dérivation. Si nous dessinons le schéma de dérivaton de la fonction du théorème \@ref(thm:deriv-chaine-1), nous obtenons l'image suivante.

```{r, echo=FALSE}
grViz("
digraph schema_derivation {

  # a 'graph' statement
  graph [overlap = true, fontsize = 8]

  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  f; x; y; t

  # several 'edge' statements
  f->x f->y x->t y->t
}
")
```

Pour dériver à la chaîne à l'aide de la figure \précédente, nous partons du haut de l'*arbre* et nous parcourons toutes les *branches* qui se rendent jusqu'à la variable par rapport à laquelle nous dérivons, en multipliant les dérivées. Nous additionnons toutes les *branches* pour obtenir la dérivée.

```{example}
Trouvez $\dfrac{dz}{dt}$ si $z=e^{xy^2}$, $x=t\cos(t)$ et $y=t\sin(t)$.
```
\vspace*{8cm}

```{example}
Trouvez $\dfrac{dz}{dt}$ si $z=\sin(x^2y)$, $x=2t^2$ et $y=2+\frac{1}{t}$.
```
\vspace*{8cm}

```{example}
Trouvez la dérivée de $y=(\sin(x))^x$ de deux manières différentes.
```
\vspace*{10cm}

Nous voulons maintenant savoir ce qui se produit lorsque nous avons une fonction $z=f(x,y)$ différentiable, $x=x(u,v)$ et $y=y(u,v)$.

```{theorem}
Soit une fonction $z=f(x,y)$ différentiable, $x=x(u,v)$ et $y=y(u,v)$. Nous avons:
\begin{align*}
\dfrac{\partial z}{\partial u} &= \dfrac{\partial f}{\partial x}\dfrac{\partial x}{\partial u} + \dfrac{\partial f}{\partial y}\dfrac{\partial y}{\partial u} \\
\dfrac{\partial z}{\partial v} &= \dfrac{\partial f}{\partial x}\dfrac{\partial x}{\partial v} + \dfrac{\partial f}{\partial y}\dfrac{\partial y}{\partial v}
\end{align*}

```
```{proof}
Nous ne ferons pas la preuve exacte mais nous allons dessiner le schéma de dérivation.
```{r, echo=FALSE}
grViz("
digraph schema_derivation {

  # a 'graph' statement
  graph [overlap = true, fontsize = 8]

  # several 'node' statements
  node [shape = box,
        fontname = Helvetica]
  f; x; y; u; v

  # several 'edge' statements
  f->x f->y x->u y->u x->v y->v
}
")
```
Remarquons que si nous suivons toutes les *branches* de l'*arbre* en multipliant les dérivées et en additionnant les branches, nous obtenons le résultat du théorème.
```

```{example}
Déterminez $\dfrac{\partial z}{\partial u}$ et $\dfrac{\partial z}{\partial v}$ si $z=x^2+y^2$, $x=uv$ et $y=\dfrac{u}{v}$.
```
\vspace*{8cm}

```{example}
Déterminez $\dfrac{\partial z}{\partial u}$ et $\dfrac{\partial z}{\partial v}$ si $z=\sqrt{x^2+y^2}$, $x=e^{uv}$ et $y=1+u^2\cos(v)$.
```
\vspace*{8cm}

### Les dérivées de surfaces implicites

Certaines surfaces sont définies de façon implicites et il est parfois plus simple de les dériver implicitement plutôt que de tenter de les dériver de façon explicite. De plus, certaines surfaces ne peuvent pas être exprimées de façon explicite.

Pour dériver de façon implicite, il faut garder en mémoire que si la fonction possède $n$ variables, alors une des $n$ variables dépend des $n-1$ autres.

```{example, label="deriv-implicite-sphere"}
Trouvez $\dfrac{\partial z}{\partial x}$ et $\dfrac{\partial z}{\partial y}$ si $x^2+y^2+z^2=R^2$, où $R$ est une constante.
```
\vspace*{8cm}

```{example}
Utilisez les dérivées trouvées à l'exemple \ref(exm:deriv-implicite-sphere) pour trouver l'équation du plan tangent à la sphère $x^2+y^2+z^2=3$ au point (1,1,1).
```
\vspace*{8cm}

```{example}
Trouvez l'équation du plan tangent à la surface $\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}+\dfrac{z^2}{c^2}=1$ au point $\left( \frac{a}{\sqrt{3}},\frac{b}{\sqrt{3}},\frac{c}{\sqrt{3}} \right)$.
```
\vspace*{8cm}

```{example}
Utilisez le changement de variables $r=x+ct$, $s=x-ct$ et $w(r,s)=u(x,t)$ pour transformer l'équation suivante:
$$ \dfrac{\partial^2 u}{\partial t^2} = c^2\dfrac{\partial^2 u}{\partial x^2} $$
```
\vspace*{10cm}

## La dérivée directionnelle



<!--chapter:end:05-derivfctvars.Rmd-->

# L'optimisation {#optimisation}


<!--chapter:end:06-optimisation.Rmd-->

# L'intégration de fonctions de plusieurs variables {#intfctvars}



<!--chapter:end:07-intfctvars.Rmd-->

